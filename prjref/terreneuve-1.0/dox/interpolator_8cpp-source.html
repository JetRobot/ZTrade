<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>interpolator.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>interpolator.cpp</h1><a href="interpolator_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include "<a class="code" href="interpolator_8h.html">./interpolator.h</a>"</span>
00002        
00003        
00004        
00005        
<a name="l00006"></a><a class="code" href="classinterpolator.html#a0">00006</a> <a class="code" href="classinterpolator.html#a0">interpolator::interpolator</a>(){}
00007 
<a name="l00008"></a><a class="code" href="classinterpolator.html#a1">00008</a> <a class="code" href="classinterpolator.html#a0">interpolator::interpolator</a>(valarray&lt;Real&gt; x, valarray&lt;Real&gt; y)
00009     :  _x(x),
00010       _y(y)
00011         {
00012         }
00013 
00014 
<a name="l00015"></a><a class="code" href="classinterpolator.html#a2">00015</a> <a class="code" href="classinterpolator.html#a0">interpolator::interpolator</a>(valarray&lt;Real&gt; x1, valarray&lt;Real&gt; x2, valarray&lt;valarray&lt;Real&gt; &gt; ymat)
00016     : _x1(x1),
00017       _x2(x2),
00018       _ymat(ymat)
00019   {
00020   }
00021 
<a name="l00022"></a><a class="code" href="classinterpolator.html#a7">00022</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classinterpolator.html#a7">interpolator::getInterpolation</a>(valarray&lt;Real&gt; xa,valarray&lt;Real&gt; ya, <a class="code" href="types_8h.html#a10">Real</a> x){
00023   <a class="code" href="types_8h.html#a6">Integer</a> j=0;
00024 
00025   <a class="code" href="types_8h.html#a10">Real</a> P1 = ya[j];
00026   <a class="code" href="types_8h.html#a10">Real</a> P2 = ya[j+1];
00027   <a class="code" href="types_8h.html#a10">Real</a> P3 = ya[j+2];
00028 
00029   <a class="code" href="types_8h.html#a10">Real</a> P12 = ((x - xa[j+1])*P1 + (xa[j] - x)*P2)/(xa[j]-xa[j+1]);
00030   <a class="code" href="types_8h.html#a10">Real</a> P23 = ((x - xa[j+2])*P2 + (xa[j+1] - x)*P3)/(xa[j+1]-xa[j+2]);
00031   <a class="code" href="types_8h.html#a10">Real</a> P123 = ((x - xa[j+2])*P12 + (xa[j] - x)*P23)/(xa[j]-xa[j+2]);
00032 
00033   <span class="keywordflow">return</span> P123;
00034 }
<a name="l00035"></a><a class="code" href="classinterpolator.html#a5">00035</a> valarray&lt;Real&gt; <a class="code" href="classinterpolator.html#a3">interpolator::interpolate</a>(valarray&lt;Real&gt; vec){
00036   <a class="code" href="types_8h.html#a6">Integer</a> n = vec.size();
00037   valarray&lt;Real&gt; result(n);
00038   <a class="code" href="types_8h.html#a6">Integer</a> i;
00039 
00040   <span class="keywordflow">for</span>(i=0;i&lt;n;i++)
00041     result[i] = <a class="code" href="classinterpolator.html#a3">interpolate</a>(vec[i]);
00042 
00043   <span class="keywordflow">return</span> result;
00044 }
00045 
<a name="l00046"></a><a class="code" href="classinterpolator.html#a8">00046</a> <a class="code" href="types_8h.html#a6">Integer</a> <a class="code" href="classinterpolator.html#a8">interpolator::getPlace</a>(<a class="code" href="types_8h.html#a10">Real</a> x){
00047   <a class="code" href="types_8h.html#a6">Integer</a> n = <a class="code" href="classinterpolator.html#r0">_x</a>.size();
00048   <a class="code" href="types_8h.html#a6">Integer</a> i = 0;
00049   <span class="keywordflow">while</span>((x&gt;<a class="code" href="classinterpolator.html#r0">_x</a>[i]) &amp;&amp; (i&lt;n))
00050     i++;
00051 
00052   <span class="keywordflow">return</span> i;
00053 }
00054 
<a name="l00055"></a><a class="code" href="classinterpolator.html#a9">00055</a> <a class="code" href="types_8h.html#a6">Integer</a> <a class="code" href="classinterpolator.html#a9">interpolator::getPlaceOnXi</a>(<a class="code" href="types_8h.html#a10">Real</a> x, <a class="code" href="types_8h.html#a6">Integer</a> i)
00056 {
00057   <a class="code" href="types_8h.html#a6">Integer</a> n = <a class="code" href="classinterpolator.html#r2">_x1</a>.size();
00058   <a class="code" href="types_8h.html#a6">Integer</a> k = 0;
00059   <span class="keywordflow">if</span> (i==1)
00060     {
00061     <span class="keywordflow">while</span>((x&gt;<a class="code" href="classinterpolator.html#r2">_x1</a>[k]) &amp;&amp; (k&lt;n))
00062       k++;
00063     }
00064   <span class="keywordflow">else</span>
00065     {
00066     <span class="keywordflow">while</span>((x&gt;<a class="code" href="classinterpolator.html#r3">_x2</a>[k]) &amp;&amp; (k&lt;n))
00067       k++;
00068     }
00069 
00070   <span class="keywordflow">return</span> k;
00071 }
00072 
00073 
00074 
<a name="l00075"></a><a class="code" href="classinterpolator.html#a3">00075</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classinterpolator.html#a3">interpolator::interpolate</a>(<a class="code" href="types_8h.html#a10">Real</a> x)
00076 {
00077   <a class="code" href="types_8h.html#a6">Integer</a> i = <a class="code" href="classinterpolator.html#a8">getPlace</a>( x);
00078   <a class="code" href="types_8h.html#a6">Integer</a> n = <a class="code" href="classinterpolator.html#r0">_x</a>.size();
00079 
00080   <span class="keywordflow">if</span>(i==0)
00081           <span class="keywordflow">return</span> <a class="code" href="classinterpolator.html#r0">_x</a>[0]; <span class="comment">//out of the boundary we return the value of the nearest point</span>
00082   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i==n)
00083           <span class="keywordflow">return</span> <a class="code" href="classinterpolator.html#r0">_x</a>[n-1];
00084   <span class="keywordflow">else</span>{
00085         <a class="code" href="types_8h.html#a6">Integer</a> j,k;
00086         valarray&lt;Real&gt; xa(3);
00087         valarray&lt;Real&gt; ya(3);
00088 
00089         <span class="keywordflow">if</span> (i=n-1) j=n-3;
00090         <span class="keywordflow">else</span> j=i-1;
00091 
00092         <span class="keywordflow">for</span>(k=0;k&lt;3;k++)
00093                 {
00094                 xa[k]=<a class="code" href="classinterpolator.html#r0">_x</a>[j+k];
00095                 ya[k]=<a class="code" href="classinterpolator.html#r1">_y</a>[j+k];
00096                 }
00097 
00098         <span class="keywordflow">return</span> <a class="code" href="classinterpolator.html#a7">getInterpolation</a>(xa, ya, x);
00099   }
00100 }
00101 
00102 
<a name="l00103"></a><a class="code" href="classinterpolator.html#a4">00103</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classinterpolator.html#a3">interpolator::interpolate</a>(<a class="code" href="types_8h.html#a10">Real</a> x1, <a class="code" href="types_8h.html#a10">Real</a> x2)
00104 {
00105 
00106         <a class="code" href="types_8h.html#a6">Integer</a> i1 = <a class="code" href="classinterpolator.html#a9">getPlaceOnXi</a>(x1, 1);
00107         <a class="code" href="types_8h.html#a6">Integer</a> i2 = <a class="code" href="classinterpolator.html#a9">getPlaceOnXi</a>(x2, 2);
00108         <a class="code" href="types_8h.html#a6">Integer</a> <a class="code" href="MersenneTwister_8cpp.html#a0">N</a> = <a class="code" href="classinterpolator.html#r2">_x1</a>.size();
00109         <a class="code" href="types_8h.html#a6">Integer</a> <a class="code" href="MersenneTwister_8cpp.html#a1">M</a> = <a class="code" href="classinterpolator.html#r3">_x2</a>.size();
00110 
00111 
00112         valarray&lt;Real&gt; xa1(3);
00113         valarray&lt;Real&gt; xa2(3);
00114         valarray&lt;Real&gt; temp(3);
00115         valarray&lt;valarray&lt;Real&gt; &gt;yx(3);
00116         valarray&lt;Real&gt; interpol1(3);
00117         valarray&lt;Real&gt; interpol2(<a class="code" href="MersenneTwister_8cpp.html#a0">N</a>);
00118         <a class="code" href="classinterpolator.html">interpolator</a> *tempInt;
00119   
00120     <a class="code" href="types_8h.html#a6">Integer</a> j,k;
00121 
00122         <span class="keywordflow">if</span> (i1==0)
00123         {
00124                 tempInt = <span class="keyword">new</span> <a class="code" href="classinterpolator.html#a0">interpolator</a>(<a class="code" href="classinterpolator.html#r3">_x2</a>, <a class="code" href="classinterpolator.html#r4">_ymat</a>[0]);
00125                 <span class="keywordflow">return</span> tempInt-&gt;<a class="code" href="classinterpolator.html#a3">interpolate</a>(x2);
00126         } 
00127         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i1==<a class="code" href="MersenneTwister_8cpp.html#a0">N</a>)
00128         {
00129                   tempInt = <span class="keyword">new</span> <a class="code" href="classinterpolator.html#a0">interpolator</a>(<a class="code" href="classinterpolator.html#r3">_x2</a>, <a class="code" href="classinterpolator.html#r4">_ymat</a>[<a class="code" href="MersenneTwister_8cpp.html#a0">N</a>-1]);
00130                   <span class="keywordflow">return</span> tempInt-&gt;<a class="code" href="classinterpolator.html#a3">interpolate</a>(x2);
00131         }
00132         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i2==0)
00133         {
00134                 <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="MersenneTwister_8cpp.html#a0">N</a>;j++)
00135                         interpol2[j] = <a class="code" href="classinterpolator.html#r4">_ymat</a>[j][0];
00136                 tempInt = <span class="keyword">new</span> <a class="code" href="classinterpolator.html#a0">interpolator</a>(<a class="code" href="classinterpolator.html#r2">_x1</a>, interpol2);
00137                 <span class="keywordflow">return</span> tempInt-&gt;<a class="code" href="classinterpolator.html#a3">interpolate</a>(x1);
00138         }
00139         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i2==<a class="code" href="MersenneTwister_8cpp.html#a1">M</a>)
00140         {
00141                 <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="MersenneTwister_8cpp.html#a0">N</a>;j++)
00142                         interpol2[j] = <a class="code" href="classinterpolator.html#r4">_ymat</a>[j][<a class="code" href="MersenneTwister_8cpp.html#a1">M</a>-1];
00143                 tempInt = <span class="keyword">new</span> <a class="code" href="classinterpolator.html#a0">interpolator</a>(<a class="code" href="classinterpolator.html#r2">_x1</a>, interpol2);
00144                 <span class="keywordflow">return</span> tempInt-&gt;<a class="code" href="classinterpolator.html#a3">interpolate</a>(x1);
00145         }
00146         <span class="keywordflow">else</span>
00147         {
00148                 <span class="keywordflow">if</span> (i1==<a class="code" href="MersenneTwister_8cpp.html#a0">N</a>-1) i1= <a class="code" href="MersenneTwister_8cpp.html#a0">N</a>-3;
00149                 <span class="keywordflow">else</span> i1--;
00150 
00151                 <span class="keywordflow">if</span> (i2==<a class="code" href="MersenneTwister_8cpp.html#a1">M</a>-1) i2=<a class="code" href="MersenneTwister_8cpp.html#a1">M</a>-3;
00152                 <span class="keywordflow">else</span> i2--;
00153 
00154                 <span class="keywordflow">for</span>(j=0;j&lt;3;j++)
00155                 {
00156                         <span class="keywordflow">for</span>(k=0;k&lt;3;k++)
00157                                 temp[k] = <a class="code" href="classinterpolator.html#r4">_ymat</a>[j+i1][k+i2];
00158 
00159                 yx[j].resize(3);
00160                 yx[j]=temp;     
00161                 }
00162 
00163                 <span class="keywordflow">for</span>(j=0;j&lt;3;j++)
00164                 {
00165                         xa1[j] = <a class="code" href="classinterpolator.html#r2">_x1</a>[j+i1];
00166                         xa2[j] = <a class="code" href="classinterpolator.html#r3">_x2</a>[j+i2];
00167                 }
00168 
00169                 <span class="keywordflow">for</span>(j=0;j&lt;3;j++)
00170                 {
00171                         interpol1[j] = <a class="code" href="classinterpolator.html#a7">getInterpolation</a>(xa2, yx[j], x2);
00172                 }
00173 
00174                 <span class="keywordflow">return</span> <a class="code" href="classinterpolator.html#a7">getInterpolation</a>(xa1, interpol1, x1);
00175         }
00176 }
00177 
00178 
<a name="l00179"></a><a class="code" href="classinterpolator.html#a6">00179</a> valarray&lt;valarray&lt;Real&gt; &gt; <a class="code" href="classinterpolator.html#a3">interpolator::interpolate</a>(valarray&lt;Real&gt; vec1, valarray&lt;Real&gt; vec2)
00180 {
00181   <a class="code" href="types_8h.html#a6">Integer</a> n1 = vec1.size();
00182   <a class="code" href="types_8h.html#a6">Integer</a> n2 = vec2.size();
00183   valarray&lt;valarray&lt;Real&gt; &gt; res(n1);
00184   valarray&lt;Real&gt; temp(n2);
00185 
00186   <a class="code" href="types_8h.html#a6">Integer</a> i,j;
00187   <span class="keywordflow">for</span>(i=0;i&lt;n1;i++)
00188     {
00189     <span class="keywordflow">for</span>(j=0;j&lt;n2;j++)
00190         temp[j] = <a class="code" href="classinterpolator.html#a3">interpolate</a>(vec1[i], vec2[j]);
00191 
00192     res[i].resize(n2);
00193     res[i] = temp;
00194     }
00195   <span class="keywordflow">return</span> res;
00196 }
00197 
<a name="l00198"></a><a class="code" href="interpolator_8cpp.html#a0">00198</a> <a class="code" href="types_8h.html#a6">Integer</a> <a class="code" href="interpolator_8cpp.html#a0">interpolatormain</a>()
00199 {
00200 
00201     valarray&lt;Real&gt; x1(4);
00202     valarray&lt;Real&gt; x2(4);
00203     valarray&lt;Real&gt; temp(4);
00204     valarray&lt;valarray&lt;Real&gt; &gt; y(4);
00205 
00206     <a class="code" href="types_8h.html#a6">Integer</a> i,j;
00207     <span class="keywordflow">for</span>(i=0;i&lt;4;i++)
00208     {
00209             x1[i]=i/10.0;
00210             x2[i]=i/10.0;
00211     }
00212     
00213     <span class="keywordflow">for</span>(i=0;i&lt;4;i++)
00214     {
00215             <span class="keywordflow">for</span>(j=0;j&lt;4;j++)
00216                   temp[j]=sin(x1[i]+x2[j]*x2[j]);
00217 
00218             y[i].resize(4);
00219             y[i]=temp;
00220     }
00221 
00222     <a class="code" href="classinterpolator.html">interpolator</a> terneuve(x1, x2, y);
00223 
00224 
00225   <a class="code" href="types_8h.html#a6">Integer</a> n1 = x1.size();
00226   <a class="code" href="types_8h.html#a6">Integer</a> n2 = x2.size();
00227 
00228 <span class="comment">//  Real tab[] = {0.15,0.25,0.35,0.45};</span>
00229 <span class="comment">//  valarray&lt;Real&gt; temp(tab, 4);</span>
00230 
00231 
00232   <a class="code" href="types_8h.html#a10">Real</a> res;
00233 
00234   <a class="code" href="types_8h.html#a10">Real</a> x_i = x1[1];
00235   <a class="code" href="types_8h.html#a10">Real</a> x_j = x2[2];
00236   <a class="code" href="types_8h.html#a10">Real</a> x_k = 0.1;
00237 <span class="comment">//  res = terneuve.interpolate(x_i,x_j);</span>
00238   res = terneuve.<a class="code" href="classinterpolator.html#a3">interpolate</a>(x_k,x_j);
00239 
00240   cout&lt;&lt;res;
00241   
00242   <span class="keywordflow">return</span> 0;
00243 
00244 
00245 }
00246 
00247 
</pre></div><hr size="1"><address style="align: right;"><small>
<b>Note: Generated nightly - reload for latest version</b><br>
Generated on Thu Dec 22 13:21:43 2005 for <a href="http://terreneuve.sourceforge.net">terreneuve</a> by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.3.6</small></address>
</body>
</html>
