<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>bond.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>bond.cpp</h1><a href="bond_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include ".\bond.h"</span>
00002 
<a name="l00003"></a><a class="code" href="classcashflow.html#a0">00003</a> <a class="code" href="classcashflow.html#a0">cashflow::cashflow</a>(valarray&lt;Date&gt; dates, valarray&lt;Real&gt; cashflows)
00004 :       _dates(dates),
00005         _cashflows(cashflows)
00006 {
00007 }
00008 
<a name="l00009"></a><a class="code" href="classcashflow.html#a2">00009</a> valarray&lt;Date&gt; <a class="code" href="classcashflow.html#a2">cashflow::getDates</a>(){
00010         <span class="keywordflow">return</span> <a class="code" href="classcashflow.html#r0">_dates</a>;
00011 }
00012 
<a name="l00013"></a><a class="code" href="classcashflow.html#a3">00013</a> valarray&lt;Real&gt;  <a class="code" href="classcashflow.html#a3">cashflow::getCashflows</a>(){
00014         <span class="keywordflow">return</span> <a class="code" href="classcashflow.html#r1">_cashflows</a>;
00015 }
00016 
00017 
<a name="l00018"></a><a class="code" href="classbond.html#a0">00018</a> <a class="code" href="classbond.html#a0">bond::bond</a>(<a class="code" href="classDate.html">Date</a> issue, <a class="code" href="classDate.html">Date</a> maturity, <a class="code" href="classDate.html">Date</a> firstcoupondate, <a class="code" href="types_8h.html#a10">Real</a> coupon, Frequency freq, <a class="code" href="types_8h.html#a10">Real</a> faceamount,DayCountConvention daycount, <a class="code" href="classyieldCurve.html">yieldCurve</a> yc)
00019 :       _issue(issue),
00020         _maturity(maturity),
00021         _firstcoupondate(firstcoupondate),
00022         _coupon(coupon),
00023         _freq(freq),
00024         _faceamount(faceamount),
00025         _daycount(daycount),
00026         _yc(yc)
00027 {
00028 }
00029 
00030 
<a name="l00031"></a><a class="code" href="classbond.html#a2">00031</a> <a class="code" href="classcashflow.html">cashflow</a> <a class="code" href="classbond.html#a2">bond::getCashflow</a>(){
00032         <a class="code" href="types_8h.html#a10">Real</a> timetomaturity = <a class="code" href="classbond.html#p2">_firstcoupondate</a>.<a class="code" href="classDate.html#a36">dayCount</a>(_maturity, <a class="code" href="classbond.html#p7">_daycount</a>);
00033         <a class="code" href="types_8h.html#a10">Real</a> numberofcashflow;
00034         <a class="code" href="types_8h.html#a10">Real</a> coupon;
00035 
00036         <a class="code" href="types_8h.html#a6">Integer</a> nbofmonth;
00037 
00038         <span class="keywordflow">switch</span> (<a class="code" href="classbond.html#p4">_freq</a>) {
00039                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a25">NoFrequency</a>:
00040                         numberofcashflow = 1.0;
00041                         coupon = 0;
00042                         nbofmonth = 0;
00043                         <span class="keywordflow">break</span>;
00044                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a26">Once</a>:
00045                         numberofcashflow = 1.0;
00046                         coupon = 0;
00047                         nbofmonth = 0;
00048                         <span class="keywordflow">break</span>;
00049                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a27">Annual</a>:
00050                         numberofcashflow = timetomaturity + 1;
00051                         coupon = <a class="code" href="classbond.html#p3">_coupon</a>;
00052                         nbofmonth = 12;
00053                         <span class="keywordflow">break</span>;
00054                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a28">Semiannual</a>:
00055                         numberofcashflow = 2.0*timetomaturity + 1;
00056                         coupon = _coupon/2.0;
00057                         nbofmonth = 6;
00058                         <span class="keywordflow">break</span>;
00059                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a29">EveryFourthMonth</a>:
00060                         numberofcashflow = 3.0*timetomaturity + 1;
00061                         coupon = _coupon/3.0;
00062                         nbofmonth = 4;
00063                         <span class="keywordflow">break</span>;
00064                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a30">Quarterly</a>:
00065                         numberofcashflow = 4.0*timetomaturity + 1;
00066                         coupon = _coupon/4.0;
00067                         nbofmonth = 3;
00068                         <span class="keywordflow">break</span>;
00069                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a31">Bimonthly</a>:
00070                         numberofcashflow = 6.0*timetomaturity + 1;
00071                         coupon = _coupon/6.0;
00072                         nbofmonth = 2;
00073                         <span class="keywordflow">break</span>;
00074                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a32">Monthly</a>:
00075                         numberofcashflow = 12.0*timetomaturity + 1;
00076                         coupon = _coupon/12.0;
00077                         nbofmonth = 1;
00078                         <span class="keywordflow">break</span>;
00079                 <span class="keywordflow">default</span>:
00080                         numberofcashflow = 1.0;
00081                         coupon = _coupon;
00082                         nbofmonth = 0;
00083                         <span class="keywordflow">break</span>;
00084         }
00085 
00086 
00087 
00088         
00089         <a class="code" href="classDate.html">Date</a> d(<a class="code" href="classbond.html#p2">_firstcoupondate</a>);
00090         <a class="code" href="types_8h.html#a7">Natural</a> numberofCF = (<span class="keywordtype">int</span>) (numberofcashflow + 0.1);
00091 
00092         valarray&lt;Date&gt; dates(numberofCF);
00093         valarray&lt;Real&gt; cashflows(numberofCF);
00094         
00095         dates[0]=d;
00096         <a class="code" href="classDate.html">Date</a> dTest;
00097         cashflows[0] = <a class="code" href="classbond.html#p5">_faceamount</a>*coupon;
00098         <a class="code" href="types_8h.html#a7">Natural</a> i;
00099         <span class="keywordflow">for</span>(i=1;i&lt;numberofCF;i++)
00100         {
00101                 dTest=d.<a class="code" href="classDate.html#a30">plusMonths</a>(i*nbofmonth);
00102                 dTest.<a class="code" href="classDate.html#a34">applyConvention</a>(<a class="code" href="date_8h.html#a47a36">Following</a>);
00103                 dates[i]=dTest;
00104                 cashflows[i] = <a class="code" href="classbond.html#p5">_faceamount</a>*coupon;
00105         }
00106 
00107         <span class="keywordflow">if</span> (<a class="code" href="classbond.html#p4">_freq</a>==<a class="code" href="date_8h.html#a46a26">Once</a>)
00108                 cashflows[0] = <a class="code" href="classbond.html#p5">_faceamount</a>;
00109         <span class="keywordflow">else</span>
00110                 cashflows[numberofCF-1] += _faceamount;
00111 
00112         <a class="code" href="classcashflow.html">cashflow</a> CF(dates, cashflows);
00113         <span class="keywordflow">return</span> CF;
00114 }
00115         
<a name="l00116"></a><a class="code" href="classbond.html#a4">00116</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classbond.html#a9">bond::fairvalue</a>(<a class="code" href="classDate.html">Date</a> today){
00117 
00118         <a class="code" href="types_8h.html#a10">Real</a> PV = <a class="code" href="classbond.html#a8">quotedPrice</a>(today);
00119         <a class="code" href="types_8h.html#a10">Real</a> accruedinterest;
00120 
00121         <span class="keywordflow">if</span>(today&lt;=_issue ||today&gt;=_maturity)
00122                 accruedinterest = 0;
00123         <span class="keywordflow">else</span>
00124         {
00125                 <a class="code" href="classcashflow.html">cashflow</a> CF = <a class="code" href="classbond.html#a2">getCashflow</a>();
00126                 valarray&lt;Date&gt; dates = CF.<a class="code" href="classcashflow.html#a2">getDates</a>();
00127                 valarray&lt;Real&gt; cashflows = CF.<a class="code" href="classcashflow.html#a3">getCashflows</a>();
00128 
00129                 <a class="code" href="types_8h.html#a7">Natural</a> i=0;
00130                 <span class="keywordflow">while</span>((dates[i]&lt;today) &amp;&amp; (i&lt;dates.size()))
00131                         i++;
00132         
00133                 <a class="code" href="classDate.html">Date</a> interestaccrualdate;
00134                 <span class="keywordflow">if</span> (today&lt;<a class="code" href="classbond.html#p2">_firstcoupondate</a>)
00135                         interestaccrualdate = <a class="code" href="classbond.html#p0">_issue</a>;
00136                 <span class="keywordflow">else</span>
00137                         interestaccrualdate = dates[i-1];
00138 
00139                 <a class="code" href="types_8h.html#a10">Real</a> numberofdays, numberofdays2, numberofcoupon;
00140 
00141 
00142                 <span class="keywordflow">switch</span>(<a class="code" href="classbond.html#p4">_freq</a>){
00143                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a25">NoFrequency</a>:
00144                                 numberofcoupon = 1.0;<span class="comment">//to avoid division by zero</span>
00145                                 <span class="keywordflow">break</span>;
00146                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a26">Once</a>:
00147                                 numberofcoupon = 1.0;
00148                                 <span class="keywordflow">break</span>;
00149                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a27">Annual</a>:
00150                                 numberofcoupon = 1.0;
00151                                 <span class="keywordflow">break</span>;
00152                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a28">Semiannual</a>:
00153                                 numberofcoupon = 2.0;
00154                                 <span class="keywordflow">break</span>;
00155                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a29">EveryFourthMonth</a>:
00156                                 numberofcoupon = 3.0;
00157                                 <span class="keywordflow">break</span>;
00158                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a30">Quarterly</a>:
00159                                 numberofcoupon = 4.0;
00160                                 <span class="keywordflow">break</span>;
00161                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a31">Bimonthly</a>:
00162                                 numberofcoupon = 6.0;
00163                                 <span class="keywordflow">break</span>;
00164                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a46a32">Monthly</a>:
00165                                 numberofcoupon = 12.0;
00166                                 <span class="keywordflow">break</span>;
00167                         <span class="keywordflow">default</span>:
00168                                 numberofcoupon = 1.0;
00169                                 <span class="keywordflow">break</span>;
00170                 }
00171 
00172 
00173                 <span class="keywordflow">switch</span> (<a class="code" href="classbond.html#p7">_daycount</a>) {
00174                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a48a39">ACT_365</a>:
00175                                 numberofdays = <a class="code" href="types_8h.html#a2">TN_REAL</a>(today.<a class="code" href="classDate.html#a10">serialNumber</a>()-interestaccrualdate.<a class="code" href="classDate.html#a10">serialNumber</a>());
00176                                 numberofdays2 = 365.0/numberofcoupon;
00177                                 <span class="keywordflow">break</span>;
00178                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a48a40">ACT_360</a>:
00179                                 numberofdays = <a class="code" href="types_8h.html#a2">TN_REAL</a>(today.<a class="code" href="classDate.html#a10">serialNumber</a>()-interestaccrualdate.<a class="code" href="classDate.html#a10">serialNumber</a>());
00180                                 numberofdays2 = 360.0/numberofcoupon;
00181                                 <span class="keywordflow">break</span>;
00182                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a48a41">Day30_365</a>:
00183                                 numberofdays = <a class="code" href="types_8h.html#a2">TN_REAL</a>(today.<a class="code" href="classDate.html#a6">dayOfMonth</a>()+30-interestaccrualdate.<a class="code" href="classDate.html#a6">dayOfMonth</a>()+30*(12*(today.<a class="code" href="classDate.html#a9">year</a>()-interestaccrualdate.<a class="code" href="classDate.html#a9">year</a>())+today.<a class="code" href="classDate.html#a8">month</a>()-interestaccrualdate.<a class="code" href="classDate.html#a8">month</a>()));
00184                                 numberofdays2 = 365.0/numberofcoupon;
00185                                 <span class="keywordflow">break</span>;
00186                         <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a48a42">Day30_360</a>:
00187                                 numberofdays = <a class="code" href="types_8h.html#a2">TN_REAL</a>(today.<a class="code" href="classDate.html#a6">dayOfMonth</a>()+30-interestaccrualdate.<a class="code" href="classDate.html#a6">dayOfMonth</a>()+30*(12*(today.<a class="code" href="classDate.html#a9">year</a>()-interestaccrualdate.<a class="code" href="classDate.html#a9">year</a>())+today.<a class="code" href="classDate.html#a8">month</a>()-interestaccrualdate.<a class="code" href="classDate.html#a8">month</a>()));
00188                                 numberofdays2 = 360.0/numberofcoupon;
00189                                 <span class="keywordflow">break</span>;
00190                         <span class="keywordflow">default</span>:
00191                                 numberofdays = <a class="code" href="types_8h.html#a2">TN_REAL</a>(today.<a class="code" href="classDate.html#a10">serialNumber</a>()-dates[i].serialNumber()); 
00192                                 numberofdays2 = 365.0/numberofcoupon;
00193                 }
00194                 accruedinterest = numberofdays/numberofdays2*<a class="code" href="classbond.html#p3">_coupon</a>/numberofcoupon*<a class="code" href="classbond.html#p5">_faceamount</a>;
00195         }
00196 
00197         <span class="keywordflow">return</span> PV + accruedinterest;
00198 }
00199 
<a name="l00200"></a><a class="code" href="classbond.html#a3">00200</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classbond.html#a8">bond::quotedPrice</a>(<a class="code" href="classDate.html">Date</a> today){
00201         
00202         <a class="code" href="classcashflow.html">cashflow</a> CF = <a class="code" href="classbond.html#a2">getCashflow</a>();
00203         valarray&lt;Date&gt; dates = CF.<a class="code" href="classcashflow.html#a2">getDates</a>();
00204         valarray&lt;Real&gt; cashflows = CF.<a class="code" href="classcashflow.html#a3">getCashflows</a>();
00205 
00206         <a class="code" href="types_8h.html#a7">Natural</a> i=0;
00207         <span class="keywordflow">while</span>((dates[i]&lt;today) &amp;&amp; (i&lt;dates.size()))
00208                 i++;
00209 
00210         <a class="code" href="types_8h.html#a10">Real</a> PV = 0;
00211         <span class="keywordflow">if</span> (i==dates.size()) <span class="keywordflow">return</span> 0;
00212         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i!=dates.size()-1){
00213                 <a class="code" href="types_8h.html#a7">Natural</a> j;
00214                 <a class="code" href="types_8h.html#a10">Real</a> timetonextCF;
00215                 <span class="keywordflow">for</span>(j=i;j&lt;dates.size();j++){
00216                         timetonextCF = today.<a class="code" href="classDate.html#a36">dayCount</a>(dates[j], <a class="code" href="classbond.html#p7">_daycount</a>);
00217                         PV += cashflows[j]*_yc.<a class="code" href="classyieldCurve.html#a12">discountFactor</a>(timetonextCF);
00218                 }
00219         }
00220 
00221 
00222         <span class="keywordflow">return</span> PV;
00223 
00224 }
00225 
<a name="l00226"></a><a class="code" href="classbond.html#a6">00226</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classbond.html#a11">bond::duration</a>(<a class="code" href="classDate.html">Date</a> today){
00227         <a class="code" href="types_8h.html#a10">Real</a> yield = <a class="code" href="classbond.html#a10">yieldToMaturity</a>(today);<span class="comment">//, _yc);</span>
00228         <a class="code" href="classcashflow.html">cashflow</a> CF = <a class="code" href="classbond.html#a2">getCashflow</a>();
00229         valarray&lt;Date&gt; dates = CF.<a class="code" href="classcashflow.html#a2">getDates</a>();
00230         valarray&lt;Real&gt; cashflows = CF.<a class="code" href="classcashflow.html#a3">getCashflows</a>();
00231 
00232         <a class="code" href="types_8h.html#a7">Natural</a> i=0;
00233         <span class="keywordflow">while</span>((dates[i]&lt;today) &amp;&amp; (i&lt;dates.size()))
00234                 i++;
00235         <span class="keywordflow">if</span> (i==dates.size()) <span class="keywordflow">return</span> 0;
00236         <a class="code" href="types_8h.html#a10">Real</a> result = 0;
00237         <a class="code" href="types_8h.html#a10">Real</a> PV = 0;
00238         <a class="code" href="types_8h.html#a10">Real</a> timetonextCF;
00239         <a class="code" href="types_8h.html#a7">Natural</a> j;
00240         <span class="keywordflow">for</span>(j=i;j&lt;dates.size();j++){
00241                         timetonextCF = today.<a class="code" href="classDate.html#a36">dayCount</a>(dates[j], <a class="code" href="classbond.html#p7">_daycount</a>);
00242                         result += cashflows[j]*exp(-yield*timetonextCF)*timetonextCF;
00243                         PV += cashflows[j]*exp(-yield*timetonextCF);
00244         }
00245 
00246         result /= PV;
00247         <span class="keywordflow">return</span> result;
00248 
00249 }
00250 
<a name="l00251"></a><a class="code" href="classbond.html#a7">00251</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classbond.html#a12">bond::convexity</a>(<a class="code" href="classDate.html">Date</a> today){
00252         <a class="code" href="types_8h.html#a10">Real</a> yield = <a class="code" href="classbond.html#a10">yieldToMaturity</a>(today);<span class="comment">//, _yc);</span>
00253         <a class="code" href="classcashflow.html">cashflow</a> CF = <a class="code" href="classbond.html#a2">getCashflow</a>();
00254         valarray&lt;Date&gt; dates = CF.<a class="code" href="classcashflow.html#a2">getDates</a>();
00255         valarray&lt;Real&gt; cashflows = CF.<a class="code" href="classcashflow.html#a3">getCashflows</a>();
00256 
00257         <a class="code" href="types_8h.html#a7">Natural</a> i=0;
00258         <span class="keywordflow">while</span>((dates[i]&lt;today) &amp;&amp; (i&lt;dates.size()))
00259                 i++;
00260         <span class="keywordflow">if</span> (i==dates.size()) <span class="keywordflow">return</span> 0;
00261         <a class="code" href="types_8h.html#a10">Real</a> result = 0;
00262         <a class="code" href="types_8h.html#a10">Real</a> PV = 0;
00263         <a class="code" href="types_8h.html#a10">Real</a> timetonextCF;
00264         <a class="code" href="types_8h.html#a7">Natural</a> j;
00265         <span class="keywordflow">for</span>(j=i;j&lt;dates.size();j++){
00266                         timetonextCF = today.<a class="code" href="classDate.html#a36">dayCount</a>(dates[j], <a class="code" href="classbond.html#p7">_daycount</a>);
00267                         result += cashflows[j]*exp(-yield*timetonextCF)*timetonextCF*timetonextCF;
00268                         PV += cashflows[j]*exp(-yield*timetonextCF);
00269         }
00270 
00271         result /= PV;
00272         <span class="keywordflow">return</span> result;
00273 
00274 }
00275 
<a name="l00276"></a><a class="code" href="classbond.html#a5">00276</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classbond.html#a10">bond::yieldToMaturity</a>(<a class="code" href="classDate.html">Date</a> today){
00277         <a class="code" href="types_8h.html#a10">Real</a> price = <a class="code" href="classbond.html#a9">fairvalue</a>(today);<span class="comment">//, _yc);</span>
00278         <a class="code" href="types_8h.html#a10">Real</a> yield = 0.05;
00279         <a class="code" href="types_8h.html#a10">Real</a> deriv_price, yield_price;
00280 
00281 
00282         <a class="code" href="classcashflow.html">cashflow</a> CF = <a class="code" href="classbond.html#a2">getCashflow</a>();
00283         valarray&lt;Date&gt; dates = CF.<a class="code" href="classcashflow.html#a2">getDates</a>();
00284         valarray&lt;Real&gt; cashflows = CF.<a class="code" href="classcashflow.html#a3">getCashflows</a>();
00285 
00286         <a class="code" href="types_8h.html#a7">Natural</a> i=0;
00287         <span class="keywordflow">while</span>((dates[i]&lt;today) &amp;&amp; (i&lt;dates.size()))
00288                 i++;
00289         <span class="keywordflow">if</span> (i==dates.size()) <span class="keywordflow">return</span> 0;
00290         
00291         <a class="code" href="types_8h.html#a10">Real</a> timetonextCF;
00292         <a class="code" href="types_8h.html#a7">Natural</a> k,j;
00293         <span class="keywordflow">for</span>(k=0;k&lt;100;k++){
00294                 deriv_price = 0;
00295                 yield_price = 0;
00296                 <span class="keywordflow">for</span>(j=i;j&lt;dates.size();j++){
00297                         timetonextCF = today.<a class="code" href="classDate.html#a36">dayCount</a>(dates[j], <a class="code" href="classbond.html#p7">_daycount</a>);
00298                         yield_price += cashflows[j]*exp(-yield*timetonextCF);
00299                         deriv_price += -timetonextCF*cashflows[j]*exp(-yield*timetonextCF);
00300                 }
00301                 yield += (price - yield_price)/deriv_price;
00302         }
00303         <span class="keywordflow">return</span> yield;
00304 
00305 }
00306 
<a name="l00307"></a><a class="code" href="classtreasurybond.html#a0">00307</a> <a class="code" href="classtreasurybond.html#a0">treasurybond::treasurybond</a>(<a class="code" href="classDate.html">Date</a> issue, <a class="code" href="classDate.html">Date</a> maturity, <a class="code" href="classDate.html">Date</a> firstcoupondate, <a class="code" href="types_8h.html#a10">Real</a> coupon, Frequency freq, <a class="code" href="types_8h.html#a10">Real</a> faceamount, DayCountConvention daycount, <a class="code" href="classyieldCurve.html">yieldCurve</a> yc)
00308 :       <a class="code" href="classbond.html">bond</a>(issue, maturity, firstcoupondate, coupon, freq, faceamount, daycount, yc)
00309 {
00310 }
00311 
<a name="l00312"></a><a class="code" href="classtreasurybond.html#a1">00312</a> <a class="code" href="classtreasurybond.html#a0">treasurybond::treasurybond</a>(<a class="code" href="classDate.html">Date</a> issue, <a class="code" href="classDate.html">Date</a> maturity, <a class="code" href="classDate.html">Date</a> firstcoupondate, <a class="code" href="types_8h.html#a10">Real</a> coupon, <a class="code" href="classyieldCurve.html">yieldCurve</a> yc)
00313 :       <a class="code" href="classbond.html">bond</a>(issue, maturity, firstcoupondate, coupon, <a class="code" href="date_8h.html#a46a28">Semiannual</a>, 100.0, <a class="code" href="date_8h.html#a48a40">ACT_360</a>, yc)
00314 {
00315 }
00316 
<a name="l00317"></a><a class="code" href="classtreasurybond.html#a2">00317</a> <a class="code" href="classtreasurybond.html#a0">treasurybond::treasurybond</a>(<a class="code" href="classDate.html">Date</a> issue, <a class="code" href="classDate.html">Date</a> maturity, <a class="code" href="types_8h.html#a10">Real</a> faceamount, DayCountConvention daycount, <a class="code" href="classyieldCurve.html">yieldCurve</a> yc)
00318 :       <a class="code" href="classbond.html">bond</a>(issue, maturity, maturity, 0.0, <a class="code" href="date_8h.html#a46a26">Once</a>, faceamount, daycount, yc)
00319 {
00320 }       
00321 
<a name="l00322"></a><a class="code" href="classtreasurybond.html#a4">00322</a> <a class="code" href="classtreasurybond.html">treasurybond</a> <a class="code" href="classtreasurybond.html#a4">treasurybond::shiftedbond</a>(<a class="code" href="types_8h.html#a10">Real</a> shift){
00323         <a class="code" href="classyieldCurve.html">yieldCurve</a> shiftedyc(_yc.<a class="code" href="classyieldCurve.html#a4">shiftZCBRateCurve</a>(shift));
00324         <a class="code" href="classtreasurybond.html">treasurybond</a> shiftedtbond(_issue, _maturity, _firstcoupondate, _coupon, _freq, _faceamount, _daycount, shiftedyc);
00325         <span class="keywordflow">return</span> shiftedtbond;
00326 }
00327 
<a name="l00328"></a><a class="code" href="classtreasurybond.html#a5">00328</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classtreasurybond.html#a6">treasurybond::rho</a>(<a class="code" href="classDate.html">Date</a> today){
00329         <a class="code" href="classtreasurybond.html">treasurybond</a> tb = <a class="code" href="classtreasurybond.html#a4">shiftedbond</a>(0.001);
00330         <a class="code" href="types_8h.html#a10">Real</a> Rho = (tb.<a class="code" href="classbond.html#a4">fairvalue</a>(today) - <a class="code" href="classbond.html#a9">fairvalue</a>(today))/0.001;
00331 
00332         <span class="keywordflow">return</span> Rho;
00333 }
00334 
00335 
<a name="l00336"></a><a class="code" href="classriskybond.html#a0">00336</a> <a class="code" href="classriskybond.html#a0">riskybond::riskybond</a>(<a class="code" href="classDate.html">Date</a> issue, <a class="code" href="classDate.html">Date</a> maturity, <a class="code" href="classDate.html">Date</a> firstcoupondate, <a class="code" href="types_8h.html#a10">Real</a> coupon, Frequency freq, <a class="code" href="types_8h.html#a10">Real</a> faceamount,DayCountConvention daycount, <a class="code" href="classyieldCurve.html">yieldCurve</a> yc,  <a class="code" href="classcreditCurve.html">creditCurve</a> cc)
00337 :       <a class="code" href="classbond.html">bond</a>(issue, maturity, firstcoupondate, coupon, freq, faceamount, daycount, yc),
00338         _cc(cc)
00339 {
00340 }
00341 
<a name="l00342"></a><a class="code" href="classriskybond.html#a1">00342</a> <a class="code" href="classriskybond.html#a0">riskybond::riskybond</a>(<a class="code" href="classDate.html">Date</a> issue, <a class="code" href="classDate.html">Date</a> maturity, <a class="code" href="types_8h.html#a10">Real</a> faceamount, DayCountConvention daycount, <a class="code" href="classyieldCurve.html">yieldCurve</a> yc,  <a class="code" href="classcreditCurve.html">creditCurve</a> cc)
00343 :       <a class="code" href="classbond.html">bond</a>(issue, maturity, maturity, 0.0, <a class="code" href="date_8h.html#a46a26">Once</a>, faceamount, daycount, yc),
00344         _cc(cc)
00345 {
00346 }
00347 
<a name="l00348"></a><a class="code" href="classriskybond.html#a3">00348</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classbond.html#a8">riskybond::quotedPrice</a>(<a class="code" href="classDate.html">Date</a> today){
00349 
00350         <a class="code" href="classcashflow.html">cashflow</a> CF = <a class="code" href="classbond.html#a2">getCashflow</a>();
00351         valarray&lt;Date&gt; dates = CF.<a class="code" href="classcashflow.html#a2">getDates</a>();
00352         valarray&lt;Real&gt; cashflows = CF.<a class="code" href="classcashflow.html#a3">getCashflows</a>();
00353 
00354         <a class="code" href="types_8h.html#a7">Natural</a> i=0;
00355         <span class="keywordflow">while</span>((dates[i]&lt;today) &amp;&amp; (i&lt;dates.size()))
00356                 i++;
00357 
00358         <a class="code" href="types_8h.html#a10">Real</a> PV = 0;
00359         <span class="keywordflow">if</span> (i==dates.size()) <span class="keywordflow">return</span> 0;
00360         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i!=dates.size()-1){
00361                 <a class="code" href="types_8h.html#a7">Natural</a> j;
00362                 <a class="code" href="types_8h.html#a10">Real</a> timetonextCF;
00363                 <span class="keywordflow">for</span>(j=i+1;j&lt;dates.size();j++){
00364                         timetonextCF = today.<a class="code" href="classDate.html#a36">dayCount</a>(dates[j], _daycount);
00365                         PV += cashflows[j]*_cc.<a class="code" href="classcreditCurve.html#a26">riskyDiscountFactor</a>(timetonextCF);
00366                 }
00367         }
00368 
00369 
00370         <span class="keywordflow">return</span> PV;
00371 
00372 }
00373 
<a name="l00374"></a><a class="code" href="classriskybond.html#a4">00374</a> <a class="code" href="classriskybond.html">riskybond</a> <a class="code" href="classriskybond.html#a4">riskybond::shiftedbond</a>(<a class="code" href="types_8h.html#a10">Real</a> shift){
00375         <a class="code" href="classyieldCurve.html">yieldCurve</a> shiftedyc(_yc.<a class="code" href="classyieldCurve.html#a4">shiftZCBRateCurve</a>(shift));
00376         <a class="code" href="classriskybond.html">riskybond</a> shiftedtbond(_issue, _maturity, _firstcoupondate, _coupon, _freq, _faceamount, _daycount, shiftedyc, _cc);
00377         <span class="keywordflow">return</span> shiftedtbond;
00378 }
00379 
<a name="l00380"></a><a class="code" href="classriskybond.html#a5">00380</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classriskybond.html#a6">riskybond::rho</a>(<a class="code" href="classDate.html">Date</a> today){
00381         <a class="code" href="classriskybond.html">riskybond</a> tb = <a class="code" href="classriskybond.html#a4">shiftedbond</a>(0.001);
00382         <a class="code" href="types_8h.html#a10">Real</a> Rho = (tb.<a class="code" href="classbond.html#a4">fairvalue</a>(today) - <a class="code" href="classbond.html#a9">fairvalue</a>(today))/0.001;
00383 
00384         <span class="keywordflow">return</span> Rho;
00385 }
</pre></div><hr size="1"><address style="align: right;"><small>
<b>Note: Generated nightly - reload for latest version</b><br>
Generated on Thu Dec 22 13:21:43 2005 for <a href="http://terreneuve.sourceforge.net">terreneuve</a> by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.3.6</small></address>
</body>
</html>
