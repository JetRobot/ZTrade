<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>date.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>date.cpp</h1><a href="date_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include ".\date.h"</span>
00002 <span class="preprocessor">#include &lt;time.h&gt;</span>
00003 
<a name="l00004"></a><a class="code" href="classDate.html#a0">00004</a> <a class="code" href="classDate.html#a0">Date::Date</a>(<span class="keywordtype">void</span>)
00005 :_serialNumber(<a class="code" href="types_8h.html#a8">LongInteger</a>(0)){
00006 }
00007 
<a name="l00008"></a><a class="code" href="classDate.html#a1">00008</a> <a class="code" href="classDate.html#a0">Date::Date</a>(<a class="code" href="types_8h.html#a8">LongInteger</a> serialNumber)
00009 : _serialNumber(serialNumber) {
00010 }
00011 
<a name="l00012"></a><a class="code" href="classDate.html#a2">00012</a> <a class="code" href="classDate.html#a0">Date::Date</a>(<a class="code" href="date_8h.html#a0">Day</a> d, Month m, <a class="code" href="date_8h.html#a1">Year</a> y){
00013         <span class="keywordtype">bool</span> leap = <a class="code" href="classDate.html#e2">isLeap</a>(y);
00014         <a class="code" href="date_8h.html#a0">Day</a> len = <a class="code" href="classDate.html#h1">monthLength</a>(<a class="code" href="ParkMiller_8h.html#a1">m</a>,leap), offset = <a class="code" href="classDate.html#h2">monthOffset</a>(<a class="code" href="ParkMiller_8h.html#a1">m</a>,leap);
00015         <a class="code" href="classDate.html#r0">_serialNumber</a> = d + offset + <a class="code" href="classDate.html#h3">yearOffset</a>(y);
00016 }
00017 
<a name="l00018"></a><a class="code" href="classDate.html#a3">00018</a> <a class="code" href="classDate.html#a0">Date::Date</a>(<a class="code" href="date_8h.html#a0">Day</a> d, <a class="code" href="types_8h.html#a5">ShortNatural</a> m, <a class="code" href="date_8h.html#a1">Year</a> y) {
00019         <span class="keywordflow">switch</span> (<a class="code" href="ParkMiller_8h.html#a1">m</a>) {
00020                         <span class="keywordflow">case</span> 1:
00021                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a9">January</a>,y);
00022                         <span class="keywordflow">case</span> 2:
00023                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a10">February</a>,y);
00024                         <span class="keywordflow">case</span> 3:
00025                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a11">March</a>,y);
00026                         <span class="keywordflow">case</span> 4:
00027                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a12">April</a>,y);
00028                         <span class="keywordflow">case</span> 5:
00029                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a13">May</a>,y);
00030                         <span class="keywordflow">case</span> 6:
00031                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a14">June</a>,y);
00032                         <span class="keywordflow">case</span> 7:
00033                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a15">July</a>,y);
00034                         <span class="keywordflow">case</span> 8:
00035                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a16">August</a>,y);
00036                         <span class="keywordflow">case</span> 9:
00037                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a17">September</a>,y);
00038                         <span class="keywordflow">case</span> 10:
00039                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a18">October</a>,y);
00040                         <span class="keywordflow">case</span> 11:
00041                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a19">November</a>,y);
00042                         <span class="keywordflow">case</span> 12:
00043                                 <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="date_8h.html#a44a20">December</a>,y);
00044         }
00045 
00046 }
00047 
<a name="l00048"></a><a class="code" href="classDate.html#a5">00048</a> <a class="code" href="date_8h.html#a43">Weekday</a> <a class="code" href="classDate.html#a5">Date::weekday</a>()<span class="keyword"> const </span>{
00049         <a class="code" href="types_8h.html#a6">Integer</a> w = <a class="code" href="classDate.html#r0">_serialNumber</a> % 7;
00050         <span class="keywordflow">return</span> <a class="code" href="date_8h.html#a43">Weekday</a>(w == 0 ? 7 : w);
00051 }
00052 
<a name="l00053"></a><a class="code" href="classDate.html#a6">00053</a> <a class="code" href="date_8h.html#a0">Day</a> <a class="code" href="classDate.html#a6">Date::dayOfMonth</a>()<span class="keyword"> const </span>{
00054         <span class="keywordflow">return</span> <a class="code" href="classDate.html#a7">dayOfYear</a>() - <a class="code" href="classDate.html#h2">monthOffset</a>(<a class="code" href="classDate.html#a8">month</a>(),<a class="code" href="classDate.html#e2">isLeap</a>(<a class="code" href="classDate.html#a9">year</a>()));
00055 }
00056 
<a name="l00057"></a><a class="code" href="classDate.html#a7">00057</a> <a class="code" href="date_8h.html#a0">Day</a> <a class="code" href="classDate.html#a7">Date::dayOfYear</a>()<span class="keyword"> const </span>{
00058         <span class="keywordflow">return</span> (<a class="code" href="date_8h.html#a0">Day</a>)(<a class="code" href="classDate.html#r0">_serialNumber</a> - <a class="code" href="classDate.html#h3">yearOffset</a>(<a class="code" href="classDate.html#a9">year</a>()));
00059 }
00060 
<a name="l00061"></a><a class="code" href="classDate.html#a8">00061</a> <a class="code" href="date_8h.html#a44">Month</a> <a class="code" href="classDate.html#a8">Date::month</a>()<span class="keyword"> const </span>{
00062         <a class="code" href="date_8h.html#a0">Day</a> d = <a class="code" href="classDate.html#a7">dayOfYear</a>();
00063         <a class="code" href="types_8h.html#a6">Integer</a> <a class="code" href="ParkMiller_8h.html#a1">m</a> = d/30 + 1;
00064         <span class="keywordtype">bool</span> leap = <a class="code" href="classDate.html#e2">isLeap</a>(<a class="code" href="classDate.html#a9">year</a>());
00065         <span class="keywordflow">while</span> (d &lt;= <a class="code" href="classDate.html#h2">monthOffset</a>(<a class="code" href="date_8h.html#a44">Month</a>(<a class="code" href="ParkMiller_8h.html#a1">m</a>),leap))
00066                 <a class="code" href="ParkMiller_8h.html#a1">m</a>--;
00067         <span class="keywordflow">while</span> (d &gt; <a class="code" href="classDate.html#h2">monthOffset</a>(<a class="code" href="date_8h.html#a44">Month</a>(<a class="code" href="ParkMiller_8h.html#a1">m</a>+1),leap))
00068                 <a class="code" href="ParkMiller_8h.html#a1">m</a>++;
00069         <span class="keywordflow">return</span> <a class="code" href="date_8h.html#a44">Month</a>(<a class="code" href="ParkMiller_8h.html#a1">m</a>);
00070 }
00071 
<a name="l00072"></a><a class="code" href="classDate.html#a9">00072</a> <a class="code" href="date_8h.html#a1">Year</a> <a class="code" href="classDate.html#a9">Date::year</a>()<span class="keyword"> const </span>{
00073         <a class="code" href="date_8h.html#a1">Year</a> y = (<a class="code" href="date_8h.html#a1">Year</a>)(1900+(<a class="code" href="classDate.html#r0">_serialNumber</a> / 365));
00074         <span class="keywordflow">if</span> (<a class="code" href="classDate.html#r0">_serialNumber</a> &lt;= <a class="code" href="classDate.html#h3">yearOffset</a>(y))
00075                 y--;
00076         <span class="keywordflow">return</span> y;
00077 }
00078 
<a name="l00079"></a><a class="code" href="classDate.html#a10">00079</a> <a class="code" href="types_8h.html#a8">LongInteger</a> <a class="code" href="classDate.html#a10">Date::serialNumber</a>()<span class="keyword"> const </span>{
00080         <span class="keywordflow">return</span> <a class="code" href="classDate.html#r0">_serialNumber</a>;
00081 }
00082 
<a name="l00083"></a><a class="code" href="classDate.html#a11">00083</a> <span class="keywordtype">bool</span> <a class="code" href="classDate.html#a11">Date::isEndOfMonth</a>()<span class="keyword"> const </span>{
00084         <span class="keywordflow">return</span> <a class="code" href="classDate.html#e4">isEOM</a>(*<span class="keyword">this</span>);
00085 }
00086 
<a name="l00087"></a><a class="code" href="classDate.html#a12">00087</a> <a class="code" href="date_8h.html#a0">Day</a> <a class="code" href="classDate.html#a12">Date::lastDayOfMonth</a>()<span class="keyword"> const </span>{
00088         <span class="keywordflow">return</span> <a class="code" href="classDate.html#e3">endOfMonth</a>(*this).<a class="code" href="classDate.html#a6">dayOfMonth</a>();
00089 }
00090 
<a name="l00091"></a><a class="code" href="classDate.html#a13">00091</a> <span class="keywordtype">void</span> <a class="code" href="classDate.html#a13">Date::setDateToToday</a>() {
00092         time_t tval = time(0);
00093         <span class="keyword">struct </span>tm *tmp= localtime(&amp;tval);
00094         <span class="keywordtype">bool</span> leap = <a class="code" href="classDate.html#e2">isLeap</a>(tmp-&gt;tm_year + 1900);
00095         <a class="code" href="date_8h.html#a0">Day</a> len = <a class="code" href="classDate.html#h1">monthLength</a>(<a class="code" href="date_8h.html#a44">Month</a>(tmp-&gt;tm_mon+1),leap), offset = <a class="code" href="classDate.html#h2">monthOffset</a>(<a class="code" href="date_8h.html#a44">Month</a>(tmp-&gt;tm_mon+1),leap);
00096         <a class="code" href="classDate.html#r0">_serialNumber</a> = tmp-&gt;tm_mday + offset + <a class="code" href="classDate.html#h3">yearOffset</a>(tmp-&gt;tm_year + 1900);
00097 }
00098 
<a name="l00099"></a><a class="code" href="classDate.html#a14">00099</a> <a class="code" href="classDate.html">Date</a>&amp; <a class="code" href="classDate.html#a14">Date::operator+=</a>(<a class="code" href="types_8h.html#a8">LongInteger</a> days) {
00100         <a class="code" href="types_8h.html#a8">LongInteger</a> serial = <a class="code" href="classDate.html#r0">_serialNumber</a> + days;
00101         <a class="code" href="classDate.html#r0">_serialNumber</a> = serial;
00102         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00103 }
00104 
<a name="l00105"></a><a class="code" href="classDate.html#a15">00105</a> <a class="code" href="classDate.html">Date</a>&amp; <a class="code" href="classDate.html#a15">Date::operator-=</a>(<a class="code" href="types_8h.html#a8">LongInteger</a> days) {
00106         <a class="code" href="types_8h.html#a8">LongInteger</a> serial = <a class="code" href="classDate.html#r0">_serialNumber</a> - days;
00107         <a class="code" href="classDate.html#r0">_serialNumber</a> = serial;
00108         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00109 }
00110 
<a name="l00111"></a><a class="code" href="classDate.html#a16">00111</a> <a class="code" href="classDate.html">Date</a>&amp; <a class="code" href="classDate.html#a16">Date::operator++</a>() {
00112         <a class="code" href="types_8h.html#a8">LongInteger</a> serial = <a class="code" href="classDate.html#r0">_serialNumber</a> + 1;
00113         <a class="code" href="classDate.html#r0">_serialNumber</a> = serial;
00114         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00115 }
00116 
<a name="l00117"></a><a class="code" href="classDate.html#a17">00117</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a16">Date::operator++</a>(<span class="keywordtype">int</span> ) {
00118         <a class="code" href="classDate.html">Date</a> temp = *<span class="keyword">this</span>;
00119         <a class="code" href="types_8h.html#a8">LongInteger</a> serial = <a class="code" href="classDate.html#r0">_serialNumber</a> + 1;
00120         <a class="code" href="classDate.html#r0">_serialNumber</a> = serial;
00121         <span class="keywordflow">return</span> temp;
00122 }
00123 
<a name="l00124"></a><a class="code" href="classDate.html#a18">00124</a> <a class="code" href="classDate.html">Date</a>&amp; <a class="code" href="classDate.html#a18">Date::operator--</a>() {
00125         <a class="code" href="types_8h.html#a8">LongInteger</a> serial = <a class="code" href="classDate.html#r0">_serialNumber</a> - 1;
00126         <a class="code" href="classDate.html#r0">_serialNumber</a> = serial;
00127         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00128 }
00129 
<a name="l00130"></a><a class="code" href="classDate.html#a19">00130</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a18">Date::operator--</a>(<span class="keywordtype">int</span> ) {
00131         <a class="code" href="classDate.html">Date</a> temp = *<span class="keyword">this</span>;
00132         <a class="code" href="types_8h.html#a8">LongInteger</a> serial = <a class="code" href="classDate.html#r0">_serialNumber</a> - 1;
00133         <a class="code" href="classDate.html#r0">_serialNumber</a> = serial;
00134         <span class="keywordflow">return</span> temp;
00135 }
00136 
<a name="l00137"></a><a class="code" href="classDate.html#a20">00137</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a20">Date::operator+</a>(<a class="code" href="types_8h.html#a8">LongInteger</a> days)<span class="keyword"> const </span>{
00138         <span class="keywordflow">return</span> <a class="code" href="classDate.html#a0">Date</a>(<a class="code" href="classDate.html#r0">_serialNumber</a>+days);
00139 }
00140 
<a name="l00141"></a><a class="code" href="classDate.html#a21">00141</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a21">Date::operator-</a>(<a class="code" href="types_8h.html#a8">LongInteger</a> days)<span class="keyword"> const </span>{
00142         <span class="keywordflow">return</span> <a class="code" href="classDate.html#a0">Date</a>(<a class="code" href="classDate.html#r0">_serialNumber</a>-days);
00143 }
00144 
<a name="l00145"></a><a class="code" href="classDate.html#a28">00145</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a28">Date::plusDays</a>(<a class="code" href="types_8h.html#a6">Integer</a> days)<span class="keyword"> const </span>{
00146         <span class="keywordflow">return</span> <a class="code" href="classDate.html#h0">advance</a>(*<span class="keyword">this</span>,days,<a class="code" href="date_8h.html#a45a21">Days</a>);
00147 }
00148 
<a name="l00149"></a><a class="code" href="classDate.html#a29">00149</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a29">Date::plusWeeks</a>(<a class="code" href="types_8h.html#a6">Integer</a> weeks)<span class="keyword"> const </span>{
00150         <span class="keywordflow">return</span> <a class="code" href="classDate.html#h0">advance</a>(*<span class="keyword">this</span>,weeks,<a class="code" href="date_8h.html#a45a22">Weeks</a>);
00151 }
00152 
<a name="l00153"></a><a class="code" href="classDate.html#a30">00153</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a30">Date::plusMonths</a>(<a class="code" href="types_8h.html#a6">Integer</a> months)<span class="keyword"> const </span>{
00154         <span class="keywordflow">return</span> <a class="code" href="classDate.html#h0">advance</a>(*<span class="keyword">this</span>,months,<a class="code" href="date_8h.html#a45a23">Months</a>);
00155 }
00156 
<a name="l00157"></a><a class="code" href="classDate.html#a31">00157</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a31">Date::plusYears</a>(<a class="code" href="types_8h.html#a6">Integer</a> years)<span class="keyword"> const </span>{
00158         <span class="keywordflow">return</span> <a class="code" href="classDate.html#h0">advance</a>(*<span class="keyword">this</span>,years,<a class="code" href="date_8h.html#a45a24">Years</a>);
00159 }
00160 
<a name="l00161"></a><a class="code" href="classDate.html#a32">00161</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a32">Date::plus</a>(<a class="code" href="types_8h.html#a6">Integer</a> n, TimeUnit units)<span class="keyword"> const </span>{
00162         <span class="keywordflow">return</span> <a class="code" href="classDate.html#h0">advance</a>(*<span class="keyword">this</span>,n,units);
00163 }
00164 
<a name="l00165"></a><a class="code" href="classDate.html#e0">00165</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#e0">Date::minDate</a>() {
00166         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classDate.html">Date</a> minimumDate(<a class="code" href="classDate.html#h4">minimumSerialNumber</a>());
00167         <span class="keywordflow">return</span> minimumDate;
00168 }
00169 
<a name="l00170"></a><a class="code" href="classDate.html#e1">00170</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#e1">Date::maxDate</a>() {
00171         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classDate.html">Date</a> maximumDate(<a class="code" href="classDate.html#h5">maximumSerialNumber</a>());
00172         <span class="keywordflow">return</span> maximumDate;
00173 }
00174 
<a name="l00175"></a><a class="code" href="classDate.html#h0">00175</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#h0">Date::advance</a>(<span class="keyword">const</span> <a class="code" href="classDate.html">Date</a>&amp; date, <a class="code" href="types_8h.html#a6">Integer</a> n, TimeUnit units) {
00176         <span class="keywordflow">switch</span> (units) {
00177                   <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a45a21">Days</a>:
00178                           <span class="keywordflow">return</span> date + n;
00179                   <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a45a22">Weeks</a>:
00180                           <span class="keywordflow">return</span> date + 7*n;
00181                   <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a45a23">Months</a>: {
00182                           <a class="code" href="date_8h.html#a0">Day</a> d = date.<a class="code" href="classDate.html#a6">dayOfMonth</a>();
00183                           <a class="code" href="types_8h.html#a6">Integer</a> <a class="code" href="ParkMiller_8h.html#a1">m</a> = <a class="code" href="types_8h.html#a6">Integer</a>(date.<a class="code" href="classDate.html#a8">month</a>())+n;
00184                           <a class="code" href="date_8h.html#a1">Year</a> y = date.<a class="code" href="classDate.html#a9">year</a>();
00185                           <span class="keywordflow">while</span> (<a class="code" href="ParkMiller_8h.html#a1">m</a> &gt; 12) {
00186                                   <a class="code" href="ParkMiller_8h.html#a1">m</a> -= 12;
00187                                   y += 1;
00188                           }
00189                           <span class="keywordflow">while</span> (<a class="code" href="ParkMiller_8h.html#a1">m</a> &lt; 1) {
00190                                   <a class="code" href="ParkMiller_8h.html#a1">m</a> += 12;
00191                                   y -= 1;
00192                           }
00193 
00194                           <a class="code" href="types_8h.html#a6">Integer</a> length = <a class="code" href="classDate.html#h1">monthLength</a>(<a class="code" href="date_8h.html#a44">Month</a>(<a class="code" href="ParkMiller_8h.html#a1">m</a>), <a class="code" href="classDate.html#e2">isLeap</a>(y));
00195                           <span class="keywordflow">if</span> (d &gt; length)
00196                                   d = length;
00197 
00198                           <span class="keywordflow">return</span> <a class="code" href="classDate.html#a0">Date</a>(d, <a class="code" href="date_8h.html#a44">Month</a>(<a class="code" href="ParkMiller_8h.html#a1">m</a>), y);
00199                                            }
00200                   <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a45a24">Years</a>: {
00201                           <a class="code" href="date_8h.html#a0">Day</a> d = date.<a class="code" href="classDate.html#a6">dayOfMonth</a>();
00202                           <a class="code" href="date_8h.html#a44">Month</a> <a class="code" href="ParkMiller_8h.html#a1">m</a> = date.<a class="code" href="classDate.html#a8">month</a>();
00203                           <a class="code" href="date_8h.html#a1">Year</a> y = date.<a class="code" href="classDate.html#a9">year</a>()+n;
00204 
00205                           <span class="keywordflow">if</span> (d == 29 &amp;&amp; <a class="code" href="ParkMiller_8h.html#a1">m</a> == <a class="code" href="date_8h.html#a44a10">February</a> &amp;&amp; !<a class="code" href="classDate.html#e2">isLeap</a>(y))
00206                                   d = 28;
00207 
00208                           <span class="keywordflow">return</span> <a class="code" href="classDate.html#a0">Date</a>(d,<a class="code" href="ParkMiller_8h.html#a1">m</a>,y);
00209                                           }
00210                   <span class="comment">//default:</span>
00211 
00212         }
00213 }
00214 
<a name="l00215"></a><a class="code" href="classDate.html#e2">00215</a> <span class="keywordtype">bool</span> <a class="code" href="classDate.html#e2">Date::isLeap</a>(<a class="code" href="date_8h.html#a1">Year</a> y) {
00216         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> YearIsLeap[] = {
00217                         <span class="comment">// 1900-1909</span>
00218                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00219                         <span class="comment">// 1910-1919</span>
00220                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00221                         <span class="comment">// 1920-1929</span>
00222                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00223                         <span class="comment">// 1930-1939</span>
00224                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00225                         <span class="comment">// 1940-1949</span>
00226                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00227                         <span class="comment">// 1950-1959</span>
00228                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00229                         <span class="comment">// 1960-1969</span>
00230                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00231                         <span class="comment">// 1970-1979</span>
00232                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00233                         <span class="comment">// 1980-1989</span>
00234                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00235                         <span class="comment">// 1990-1999</span>
00236                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00237                         <span class="comment">// 2000-2009</span>
00238                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00239                         <span class="comment">// 2010-2019</span>
00240                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00241                         <span class="comment">// 2020-2029</span>
00242                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00243                         <span class="comment">// 2030-2039</span>
00244                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00245                         <span class="comment">// 2040-2049</span>
00246                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00247                         <span class="comment">// 2050-2059</span>
00248                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00249                         <span class="comment">// 2060-2069</span>
00250                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00251                         <span class="comment">// 2070-2079</span>
00252                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00253                         <span class="comment">// 2080-2089</span>
00254                         <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,
00255                         <span class="comment">// 2090-2099</span>
00256                         <span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>, <span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,
00257                         <span class="comment">// 2100</span>
00258                         <span class="keyword">false</span>
00259         };
00260         <span class="keywordflow">return</span> YearIsLeap[y-1900];
00261 }
00262 
<a name="l00263"></a><a class="code" href="classDate.html#e3">00263</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#e3">Date::endOfMonth</a>(<span class="keyword">const</span> <a class="code" href="classDate.html">Date</a>&amp; d) {
00264         <a class="code" href="date_8h.html#a44">Month</a> <a class="code" href="ParkMiller_8h.html#a1">m</a> = d.<a class="code" href="classDate.html#a8">month</a>();
00265         <a class="code" href="date_8h.html#a1">Year</a> y = d.<a class="code" href="classDate.html#a9">year</a>();
00266         <span class="keywordflow">return</span> <a class="code" href="classDate.html#a0">Date</a>(<a class="code" href="classDate.html#h1">monthLength</a>(<a class="code" href="ParkMiller_8h.html#a1">m</a>, <a class="code" href="classDate.html#e2">isLeap</a>(y)), <a class="code" href="ParkMiller_8h.html#a1">m</a>, y);
00267 }
00268 
<a name="l00269"></a><a class="code" href="classDate.html#e4">00269</a> <span class="keywordtype">bool</span> <a class="code" href="classDate.html#e4">Date::isEOM</a>(<span class="keyword">const</span> <a class="code" href="classDate.html">Date</a>&amp; d) {
00270         <span class="keywordflow">return</span> (d.<a class="code" href="classDate.html#a6">dayOfMonth</a>() == <a class="code" href="classDate.html#h1">monthLength</a>(d.<a class="code" href="classDate.html#a8">month</a>(), <a class="code" href="classDate.html#e2">isLeap</a>(d.<a class="code" href="classDate.html#a9">year</a>())));
00271 }
00272 
<a name="l00273"></a><a class="code" href="classDate.html#e5">00273</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#e5">Date::nextWeekday</a>(<span class="keyword">const</span> <a class="code" href="classDate.html">Date</a>&amp; d, Weekday dayOfWeek) {
00274         <a class="code" href="date_8h.html#a43">Weekday</a> wd = d.<a class="code" href="classDate.html#a5">weekday</a>();
00275         <span class="keywordflow">return</span> d + ((wd&gt;dayOfWeek ? 7 : 0) - wd + dayOfWeek);
00276 }
00277 
<a name="l00278"></a><a class="code" href="classDate.html#e6">00278</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#e6">Date::nthWeekday</a>(<a class="code" href="types_8h.html#a4">ShortInteger</a> nth, Weekday dayOfWeek, Month m, <a class="code" href="date_8h.html#a1">Year</a> y) 
00279 {
00280         <a class="code" href="date_8h.html#a43">Weekday</a> first = <a class="code" href="classDate.html#a0">Date</a>(1, <a class="code" href="ParkMiller_8h.html#a1">m</a>, y).weekday();
00281         <a class="code" href="types_8h.html#a4">ShortInteger</a> skip = nth - (dayOfWeek&gt;=first ? 1 : 0);
00282         <span class="keywordflow">return</span> <a class="code" href="classDate.html#a0">Date</a>(1 + dayOfWeek-first + skip*7, <a class="code" href="ParkMiller_8h.html#a1">m</a>, y);
00283 }
00284 
<a name="l00285"></a><a class="code" href="classDate.html#h1">00285</a> <a class="code" href="types_8h.html#a6">Integer</a> <a class="code" href="classDate.html#h1">Date::monthLength</a>(Month m, <span class="keywordtype">bool</span> leapYear) {
00286         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="types_8h.html#a6">Integer</a> MonthLength[] = {
00287                 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31
00288         };
00289         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="types_8h.html#a6">Integer</a> MonthLeapLength[] = {
00290                 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31
00291         };
00292         <span class="keywordflow">return</span> (leapYear? MonthLeapLength[<a class="code" href="ParkMiller_8h.html#a1">m</a>-1] : MonthLength[<a class="code" href="ParkMiller_8h.html#a1">m</a>-1]);
00293 }
00294 
<a name="l00295"></a><a class="code" href="classDate.html#h2">00295</a> <a class="code" href="types_8h.html#a6">Integer</a> <a class="code" href="classDate.html#h2">Date::monthOffset</a>(Month m, <span class="keywordtype">bool</span> leapYear) {
00296         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="types_8h.html#a6">Integer</a> MonthOffset[] = {
00297                 0,  31,  59,  90, 120, 151, 181, 212, 243, 273, 304, 334,
00298                         365     <span class="comment">// used in dayOfMonth to bracket day</span>
00299         };
00300         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="types_8h.html#a6">Integer</a> MonthLeapOffset[] = {
00301                 0,  31,  60,  91, 121, 152,     182, 213, 244, 274, 305, 335,
00302                         366     <span class="comment">// used in dayOfMonth to bracket day</span>
00303         };
00304         <span class="keywordflow">return</span> (leapYear? MonthLeapOffset[<a class="code" href="ParkMiller_8h.html#a1">m</a>-1] : MonthOffset[<a class="code" href="ParkMiller_8h.html#a1">m</a>-1]);
00305 }
<a name="l00306"></a><a class="code" href="classDate.html#h3">00306</a> <a class="code" href="types_8h.html#a8">LongInteger</a> <a class="code" href="classDate.html#h3">Date::yearOffset</a>(<a class="code" href="date_8h.html#a1">Year</a> y) {
00307         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="types_8h.html#a8">LongInteger</a> YearOffset[] = {
00308                         <span class="comment">// 1900-1909</span>
00309                         0,  366,  731, 1096, 1461, 1827, 2192, 2557, 2922, 3288,
00310                         <span class="comment">// 1910-1919</span>
00311                         3653, 4018, 4383, 4749, 5114, 5479, 5844, 6210, 6575, 6940,
00312                         <span class="comment">// 1920-1929</span>
00313                         7305, 7671, 8036, 8401, 8766, 9132, 9497, 9862,10227,10593,
00314                         <span class="comment">// 1930-1939</span>
00315                         10958,11323,11688,12054,12419,12784,13149,13515,13880,14245,
00316                         <span class="comment">// 1940-1949</span>
00317                         14610,14976,15341,15706,16071,16437,16802,17167,17532,17898,
00318                         <span class="comment">// 1950-1959</span>
00319                         18263,18628,18993,19359,19724,20089,20454,20820,21185,21550,
00320                         <span class="comment">// 1960-1969</span>
00321                         21915,22281,22646,23011,23376,23742,24107,24472,24837,25203,
00322                         <span class="comment">// 1970-1979</span>
00323                         25568,25933,26298,26664,27029,27394,27759,28125,28490,28855,
00324                         <span class="comment">// 1980-1989</span>
00325                         29220,29586,29951,30316,30681,31047,31412,31777,32142,32508,
00326                         <span class="comment">// 1990-1999</span>
00327                         32873,33238,33603,33969,34334,34699,35064,35430,35795,36160,
00328                         <span class="comment">// 2000-2009</span>
00329                         36525,36891,37256,37621,37986,38352,38717,39082,39447,39813,
00330                         <span class="comment">// 2010-2019</span>
00331                         40178,40543,40908,41274,41639,42004,42369,42735,43100,43465,
00332                         <span class="comment">// 2020-2029</span>
00333                         43830,44196,44561,44926,45291,45657,46022,46387,46752,47118,
00334                         <span class="comment">// 2030-2039</span>
00335                         47483,47848,48213,48579,48944,49309,49674,50040,50405,50770,
00336                         <span class="comment">// 2040-2049</span>
00337                         51135,51501,51866,52231,52596,52962,53327,53692,54057,54423,
00338                         <span class="comment">// 2050-2059</span>
00339                         54788,55153,55518,55884,56249,56614,56979,57345,57710,58075,
00340                         <span class="comment">// 2060-2069</span>
00341                         58440,58806,59171,59536,59901,60267,60632,60997,61362,61728,
00342                         <span class="comment">// 2070-2079</span>
00343                         62093,62458,62823,63189,63554,63919,64284,64650,65015,65380,
00344                         <span class="comment">// 2080-2089</span>
00345                         65745,66111,66476,66841,67206,67572,67937,68302,68667,69033,
00346                         <span class="comment">// 2090-2099</span>
00347                         69398,69763,70128,70494,70859,71224,71589,71955,72320,72685,
00348                         <span class="comment">// 2100</span>
00349                         73050
00350         };
00351         <span class="keywordflow">return</span> YearOffset[y-1900];
00352 }
00353 
<a name="l00354"></a><a class="code" href="classDate.html#h4">00354</a> <a class="code" href="types_8h.html#a8">LongInteger</a> <a class="code" href="classDate.html#h4">Date::minimumSerialNumber</a>() {
00355         <span class="keywordflow">return</span> 367;
00356 }
00357 
<a name="l00358"></a><a class="code" href="classDate.html#h5">00358</a> <a class="code" href="types_8h.html#a8">LongInteger</a> <a class="code" href="classDate.html#h5">Date::maximumSerialNumber</a>() {
00359         <span class="keywordflow">return</span> 73050;    <span class="comment">// Dec 31, 2099</span>
00360 }
00361 
<a name="l00362"></a><a class="code" href="classDate.html#a33">00362</a> <span class="keywordtype">bool</span> <a class="code" href="classDate.html#a33">Date::isBusinessDay</a>() {
00363         <span class="keywordflow">return</span> 1;
00364 }
00365 
<a name="l00366"></a><a class="code" href="classDate.html#a34">00366</a> <span class="keywordtype">void</span> <a class="code" href="classDate.html#a34">Date::applyConvention</a>(BusinessDayConvention convention) {
00367         <span class="keywordflow">switch</span> (convention) {
00368                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a47a34">Preceding</a>:
00369                         <span class="keywordflow">while</span> (!<a class="code" href="classDate.html#a33">isBusinessDay</a>()) {<a class="code" href="classDate.html#r0">_serialNumber</a>--;};
00370                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a47a35">ModifiedPreceding</a>: {
00371                         <a class="code" href="types_8h.html#a8">LongInteger</a> ser=<a class="code" href="classDate.html#r0">_serialNumber</a>;
00372                         <span class="keywordflow">while</span> (!<a class="code" href="classDate.html#a33">isBusinessDay</a>()) {_serialNumber--;};
00373                         <span class="keywordflow">if</span> (<a class="code" href="classDate.html#a0">Date</a>(ser).month()!=<a class="code" href="classDate.html#a8">month</a>()) {
00374                                 _serialNumber=ser;
00375                                 <span class="keywordflow">while</span> (!<a class="code" href="classDate.html#a33">isBusinessDay</a>()) {_serialNumber++;};
00376                         }
00377                 }
00378                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a47a36">Following</a>:
00379                         <span class="keywordflow">while</span> (!<a class="code" href="classDate.html#a33">isBusinessDay</a>()) {<a class="code" href="classDate.html#r0">_serialNumber</a>++;};
00380                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a47a37">ModifiedFollowing</a>: {
00381                         <a class="code" href="types_8h.html#a8">LongInteger</a> ser=<a class="code" href="classDate.html#r0">_serialNumber</a>;
00382                         <span class="keywordflow">while</span> (!<a class="code" href="classDate.html#a33">isBusinessDay</a>()) {_serialNumber++;};
00383                         <span class="keywordflow">if</span> (<a class="code" href="classDate.html#a0">Date</a>(ser).month()!=<a class="code" href="classDate.html#a8">month</a>()) {
00384                                 _serialNumber=ser;
00385                                 <span class="keywordflow">while</span> (!<a class="code" href="classDate.html#a33">isBusinessDay</a>()) {_serialNumber--;};
00386                         }
00387                 }
00388         }
00389 }               
00390 
<a name="l00391"></a><a class="code" href="classDate.html#a35">00391</a> <a class="code" href="classDate.html">Date</a> <a class="code" href="classDate.html#a35">Date::returnDateConvention</a>(<span class="keyword">const</span> <a class="code" href="classDate.html">Date</a>&amp; date, BusinessDayConvention convention) {
00392         <a class="code" href="classDate.html">Date</a> d1=<a class="code" href="classDate.html#a0">Date</a>(date.<a class="code" href="classDate.html#a10">serialNumber</a>());
00393         d1.<a class="code" href="classDate.html#a34">applyConvention</a>(convention);
00394         <span class="keywordflow">return</span> d1;
00395 }
00396 
<a name="l00397"></a><a class="code" href="classDate.html#a36">00397</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classDate.html#a36">Date::dayCount</a>(<span class="keyword">const</span> <a class="code" href="classDate.html">Date</a>&amp; d,DayCountConvention dayconvention)<span class="keyword"> const </span>{
00398         <span class="keywordflow">switch</span> (dayconvention) {
00399                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a48a39">ACT_365</a>:
00400                         <span class="keywordflow">return</span> (<a class="code" href="types_8h.html#a2">TN_REAL</a>(d.<a class="code" href="classDate.html#a10">serialNumber</a>()-<a class="code" href="classDate.html#r0">_serialNumber</a>)/365);
00401                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a48a40">ACT_360</a>:
00402                         <span class="keywordflow">return</span> (<a class="code" href="types_8h.html#a2">TN_REAL</a>(d.<a class="code" href="classDate.html#a10">serialNumber</a>()-<a class="code" href="classDate.html#r0">_serialNumber</a>)/360);
00403                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a48a41">Day30_365</a>:
00404                         <span class="keywordflow">return</span> (<a class="code" href="types_8h.html#a2">TN_REAL</a>(d.<a class="code" href="classDate.html#a6">dayOfMonth</a>()+30-<a class="code" href="classDate.html#a6">dayOfMonth</a>()+30*(12*(d.<a class="code" href="classDate.html#a9">year</a>()-<a class="code" href="classDate.html#a9">year</a>())+d.<a class="code" href="classDate.html#a8">month</a>()-<a class="code" href="classDate.html#a8">month</a>()))/365);
00405                 <span class="keywordflow">case</span> <a class="code" href="date_8h.html#a48a42">Day30_360</a>:
00406                         <span class="keywordflow">return</span> (<a class="code" href="types_8h.html#a2">TN_REAL</a>(d.<a class="code" href="classDate.html#a6">dayOfMonth</a>()+30-<a class="code" href="classDate.html#a6">dayOfMonth</a>()+30*(12*(d.<a class="code" href="classDate.html#a9">year</a>()-<a class="code" href="classDate.html#a9">year</a>())+d.<a class="code" href="classDate.html#a8">month</a>()-<a class="code" href="classDate.html#a8">month</a>()))/360);
00407                 <span class="keywordflow">default</span>:
00408                         <span class="keywordflow">return</span> (<a class="code" href="types_8h.html#a2">TN_REAL</a>(d.<a class="code" href="classDate.html#a10">serialNumber</a>()-<a class="code" href="classDate.html#r0">_serialNumber</a>)/365);
00409         }
00410 }
00411 
<a name="l00412"></a><a class="code" href="classDate.html#a37">00412</a> <span class="keywordtype">char</span>* <a class="code" href="classDate.html#a37">Date::toString</a>()<span class="keyword"> const </span>{
00413         <span class="keywordtype">char</span>* strDate=<span class="keyword">new</span> <span class="keywordtype">char</span>[10];
00414         sprintf(strDate,<span class="stringliteral">"%d/%d/%d"</span>,<a class="code" href="classDate.html#a8">month</a>(),<a class="code" href="classDate.html#a6">dayOfMonth</a>(),<a class="code" href="classDate.html#a9">year</a>());
00415         <span class="keywordflow">return</span> strDate;
00416 }
00417 
<a name="l00418"></a><a class="code" href="classDate.html#a4">00418</a> <a class="code" href="classDate.html#a4">Date::~Date</a>(<span class="keywordtype">void</span>)
00419 {
00420 }
</pre></div><hr size="1"><address style="align: right;"><small>
<b>Note: Generated nightly - reload for latest version</b><br>
Generated on Thu Dec 22 13:21:43 2005 for <a href="http://terreneuve.sourceforge.net">terreneuve</a> by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.3.6</small></address>
</body>
</html>
