<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>VarianceSwap.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>VarianceSwap.cpp</h1><a href="VarianceSwap_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include "<a class="code" href="VarianceSwap_8h.html">./VarianceSwap.h</a>"</span>
00002 
<a name="l00003"></a><a class="code" href="classVarianceSwap.html#a0">00003</a> <a class="code" href="classVarianceSwap.html#a0">VarianceSwap::VarianceSwap</a>(<a class="code" href="classOptionStrategy.html">OptionStrategy</a>* options, <a class="code" href="types_8h.html#a10">Real</a> maturity, <a class="code" href="types_8h.html#a10">Real</a> forwardprice)
00004         :       _options(options),
00005                 _maturity(maturity),
00006                 _forward(forwardprice)
00007 {
00008 }
00009 
<a name="l00010"></a><a class="code" href="classVarianceSwap.html#a1">00010</a> <a class="code" href="classVarianceSwap.html#a1">VarianceSwap::~VarianceSwap</a>(<span class="keywordtype">void</span>)
00011 {
00012 }
00013 
<a name="l00014"></a><a class="code" href="classVarianceSwap.html#a2">00014</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classVarianceSwap.html#a2">VarianceSwap::getPrice</a>() {
00015         <a class="code" href="types_8h.html#a10">Real</a> result=0;
00016         <span class="comment">//Create vectors to store indexes of options to use</span>
00017         valarray&lt;Integer&gt; putsToUse;
00018         valarray&lt;Integer&gt; callsToUse;
00019         putsToUse.resize(<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a18">returnNbOptions</a>());
00020         callsToUse.resize(<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a18">returnNbOptions</a>());
00021         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a7">Natural</a> i=0;i&lt;putsToUse.size();i++) {
00022                 putsToUse[i]=-1;
00023                 callsToUse[i]=-1;
00024         }
00025 
00026         <a class="code" href="types_8h.html#a6">Integer</a> countCalls=0;
00027         <a class="code" href="types_8h.html#a6">Integer</a> countPuts=0;
00028         <a class="code" href="classBlackScholes.html">BlackScholes</a>* bs;
00029         <a class="code" href="classBlackScholes.html">BlackScholes</a>* bs2;
00030         <a class="code" href="types_8h.html#a10">Real</a> Strike1;
00031         <a class="code" href="types_8h.html#a10">Real</a> Strike2;
00032 
00033         <span class="comment">//Search _options for options to use</span>
00034         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a6">Integer</a> i=0;i&lt;(<a class="code" href="types_8h.html#a6">Integer</a>)<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a18">returnNbOptions</a>();i++) {
00035                 bs=<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a19">returnOption</a>(i);
00036                 <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="classBlackScholes.html#a14">isCall</a>() &amp;&amp; (bs-&gt;<a class="code" href="classBlackScholes.html#a10">getStrike</a>()&gt;=<a class="code" href="classVarianceSwap.html#r2">_forward</a>)) {
00037                         callsToUse[countCalls]=i;
00038                         countCalls++;
00039                 }
00040                 <span class="keywordflow">if</span> (!(bs-&gt;<a class="code" href="classBlackScholes.html#a14">isCall</a>()) &amp;&amp; (bs-&gt;<a class="code" href="classBlackScholes.html#a10">getStrike</a>()&lt;=<a class="code" href="classVarianceSwap.html#r2">_forward</a>)) {
00041                         putsToUse[countPuts]=i;
00042                         countPuts++;
00043                 }
00044         }
00045 
00046         <span class="comment">//Compute the formula</span>
00047         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a6">Integer</a> i=0;i&lt;countPuts-1;i++) {
00048                 bs2=<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a19">returnOption</a>(putsToUse[i+1]);
00049                 bs=<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a19">returnOption</a>(putsToUse[i]);
00050                 Strike1=bs-&gt;<a class="code" href="classBlackScholes.html#a10">getStrike</a>();
00051                 Strike2=bs2-&gt;<a class="code" href="classBlackScholes.html#a10">getStrike</a>();
00052                 result+=(Strike2-Strike1)*1/(Strike1*Strike1)*bs-&gt;<a class="code" href="classBlackScholes.html#a3">getPrice</a>();
00053         }
00054         <span class="keywordflow">if</span> (countCalls&gt;0 &amp;&amp; countPuts&gt;0) {
00055                 bs=<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a19">returnOption</a>(putsToUse[countPuts-1]);
00056                 bs2=<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a19">returnOption</a>(callsToUse[0]);
00057                 Strike1=bs-&gt;<a class="code" href="classBlackScholes.html#a10">getStrike</a>();
00058                 Strike2=bs2-&gt;<a class="code" href="classBlackScholes.html#a10">getStrike</a>();
00059                 result+=(Strike2-Strike1)*1/(Strike1*Strike1)*bs-&gt;<a class="code" href="classBlackScholes.html#a3">getPrice</a>();
00060         }
00061         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a6">Integer</a> i=0;i&lt;countCalls-1;i++) {
00062                 bs2=<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a19">returnOption</a>(callsToUse[i+1]);
00063                 bs=<a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a19">returnOption</a>(callsToUse[i]);
00064                 Strike1=bs-&gt;<a class="code" href="classBlackScholes.html#a10">getStrike</a>();
00065                 Strike2=bs2-&gt;<a class="code" href="classBlackScholes.html#a10">getStrike</a>();
00066                 result+=(Strike2-Strike1)*1/(Strike1*Strike1)*bs-&gt;<a class="code" href="classBlackScholes.html#a3">getPrice</a>();
00067         }
00068 
00069         <span class="keywordflow">return</span> 2./_maturity*result;
00070 }
00071 
<a name="l00072"></a><a class="code" href="classVarianceSwap.html#a3">00072</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classVarianceSwap.html#a3">VarianceSwap::getRho</a>(<a class="code" href="types_8h.html#a10">Real</a> shiftCurve) {
00073         <span class="keywordtype">double</span> result=<a class="code" href="classVarianceSwap.html#a2">getPrice</a>();
00074         <a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a21">changeRate</a>(shiftCurve);
00075         result=<a class="code" href="classVarianceSwap.html#a2">getPrice</a>()-result;
00076         <span class="keywordflow">return</span> result;
00077 }
00078 
<a name="l00079"></a><a class="code" href="classVarianceSwap.html#a4">00079</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classVarianceSwap.html#a4">VarianceSwap::getVega</a>(<a class="code" href="types_8h.html#a10">Real</a> shiftVol) {
00080         <span class="keywordtype">double</span> result=<a class="code" href="classVarianceSwap.html#a2">getPrice</a>();
00081         <a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a22">changeVol</a>(shiftVol);
00082         result=<a class="code" href="classVarianceSwap.html#a2">getPrice</a>()-result;
00083         <span class="keywordflow">return</span> result;
00084 }
00085 
<a name="l00086"></a><a class="code" href="classVarianceSwap.html#a5">00086</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classVarianceSwap.html#a5">VarianceSwap::getTheta</a>(<a class="code" href="types_8h.html#a10">Real</a> shiftMat) {
00087         <span class="keywordtype">double</span> result=<a class="code" href="classVarianceSwap.html#a2">getPrice</a>();
00088         <a class="code" href="classVarianceSwap.html#r0">_options</a>-&gt;<a class="code" href="classOptionStrategy.html#a23">changeMaturity</a>(shiftMat);
00089         result=<a class="code" href="classVarianceSwap.html#a2">getPrice</a>()-result;
00090         <span class="keywordflow">return</span> result;
00091 }
</pre></div><hr size="1"><address style="align: right;"><small>
<b>Note: Generated nightly - reload for latest version</b><br>
Generated on Thu Dec 22 13:21:45 2005 for <a href="http://terreneuve.sourceforge.net">terreneuve</a> by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.3.6</small></address>
</body>
</html>
