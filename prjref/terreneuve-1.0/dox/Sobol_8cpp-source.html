<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Sobol.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>Sobol.cpp</h1><a href="Sobol_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include ".\sobol.h"</span>
00002 <span class="preprocessor">#include &lt;minmax.h&gt;</span>
00003 
<a name="l00004"></a><a class="code" href="classSobol.html#a0">00004</a> <a class="code" href="classSobol.html#a0">Sobol::Sobol</a>(<a class="code" href="types_8h.html#a9">LongNatural</a> Seed_)
00005 {
00006         Seed=Seed_;
00007         <a class="code" href="classSobol.html#r1">n_</a>=-1;
00008         <a class="code" href="classSobol.html#a2">sobseq</a>(&amp;<a class="code" href="classSobol.html#r1">n_</a>,<a class="code" href="classSobol.html#r2">x_</a>);
00009         <a class="code" href="classSobol.html#r1">n_</a>=1;
00010 }
00011 
<a name="l00012"></a><a class="code" href="classSobol.html#a1">00012</a> <a class="code" href="classSobol.html#a1">Sobol::~Sobol</a>()
00013 {
00014 }
00015 
<a name="l00016"></a><a class="code" href="classSobol.html#a5">00016</a> <span class="keywordtype">void</span> <a class="code" href="classSobol.html#a5">Sobol::SetSeed</a>(<a class="code" href="types_8h.html#a9">LongNatural</a> Seed_) {
00017         Seed=Seed_;
00018         <a class="code" href="classSobol.html#r1">n_</a>=-1;
00019         <a class="code" href="classSobol.html#a2">sobseq</a>(&amp;<a class="code" href="classSobol.html#r1">n_</a>,<a class="code" href="classSobol.html#r2">x_</a>);
00020         <a class="code" href="classSobol.html#r1">n_</a>=1;
00021 }
00022 
<a name="l00023"></a><a class="code" href="classSobol.html#a2">00023</a> <span class="keywordtype">void</span> <a class="code" href="classSobol.html#a2">Sobol::sobseq</a>(<a class="code" href="types_8h.html#a6">Integer</a> *n, <a class="code" href="types_8h.html#a10">Real</a> x[])
00024 {
00025         <a class="code" href="types_8h.html#a7">Natural</a> j,k,l;
00026         <a class="code" href="types_8h.html#a8">LongInteger</a> i,im,ipp;
00027         <span class="keyword">static</span> <a class="code" href="types_8h.html#a9">LongNatural</a> mdeg[MAXDIM+1]={0,1,2,3,3,4,4};
00028         <span class="keyword">static</span> <a class="code" href="types_8h.html#a9">LongNatural</a> in;
00029         <span class="keyword">static</span> <a class="code" href="types_8h.html#a9">LongNatural</a> ix[MAXDIM+1];
00030         <span class="keyword">static</span> <a class="code" href="types_8h.html#a9">LongNatural</a> *iu[<a class="code" href="Sobol_8h.html#a0">MAXBIT</a>+1];
00031         <span class="keyword">static</span> <a class="code" href="types_8h.html#a9">LongNatural</a> ip[MAXDIM+1]={0,0,1,1,2,1,4};
00032         <span class="keyword">static</span> <a class="code" href="types_8h.html#a9">LongNatural</a> iv[MAXDIM*<a class="code" href="Sobol_8h.html#a0">MAXBIT</a>+1]=
00033                 {0,1,1,1,1,1,1,3,1,3,3,1,1,5,7,7,3,3,5,15,11,5,15,13,9};
00034         <span class="keyword">static</span> <a class="code" href="types_8h.html#a10">Real</a> fac;
00035 
00036         <span class="keywordflow">if</span> (*n &lt; 0) {
00037                 <span class="keywordflow">for</span> (k=1;k&lt;MAXDIM;k++) ix[k]=0;
00038                 in=0;
00039                 <span class="keywordflow">if</span> (iv[1] != 1) <span class="keywordflow">return</span>;
00040                 fac=1.0/(1L &lt;&lt; <a class="code" href="Sobol_8h.html#a0">MAXBIT</a>);
00041                 <span class="keywordflow">for</span> (j=1,k=0;j&lt;=<a class="code" href="Sobol_8h.html#a0">MAXBIT</a>;j++,k+=MAXDIM) iu[j] = &amp;iv[k];
00042                 <span class="keywordflow">for</span> (k=1;k&lt;=MAXDIM;k++) {
00043                         <span class="keywordflow">for</span> (j=1;j&lt;=mdeg[k];j++) iu[j][k] &lt;&lt;= (<a class="code" href="Sobol_8h.html#a0">MAXBIT</a>-j);
00044                         <span class="keywordflow">for</span> (j=mdeg[k]+1;j&lt;=<a class="code" href="Sobol_8h.html#a0">MAXBIT</a>;j++) {
00045                                 ipp=ip[k];
00046                                 i=iu[j-mdeg[k]][k];
00047                                 i ^= (i &gt;&gt; mdeg[k]);
00048                                 <span class="keywordflow">for</span> (l=mdeg[k]-1;l&gt;=1;l--) {
00049                                         <span class="keywordflow">if</span> (ipp &amp; 1) i ^= iu[j-l][k];
00050                                         ipp &gt;&gt;= 1;
00051                                 }
00052                                 iu[j][k]=i;
00053                         }
00054                 }
00055         } <span class="keywordflow">else</span> {
00056                 im=in++;
00057                 <span class="keywordflow">for</span> (j=1;j&lt;=<a class="code" href="Sobol_8h.html#a0">MAXBIT</a>;j++) {
00058                         <span class="keywordflow">if</span> (!(im &amp; 1)) <span class="keywordflow">break</span>;
00059                         im &gt;&gt;= 1;
00060                 }
00061                 <span class="keywordflow">if</span> (j &gt; <a class="code" href="Sobol_8h.html#a0">MAXBIT</a>)
00062                         j=<a class="code" href="Sobol_8h.html#a0">MAXBIT</a>;
00063                 im=(j-1)*MAXDIM;
00064                 <span class="keywordflow">for</span> (k=1;k&lt;=min(*n,MAXDIM);k++) {
00065                         ix[k] ^= iv[im+k];
00066                         x[k]=ix[k]*fac;
00067                 }
00068         }
00069 }
00070 
<a name="l00071"></a><a class="code" href="classSobol.html#a6">00071</a> <a class="code" href="types_8h.html#a12">VeryLongNatural</a> <a class="code" href="classSobol.html#a6">Sobol::Max</a>() {
00072     <span class="keywordflow">return</span> 2;
00073 }
00074 
<a name="l00075"></a><a class="code" href="classSobol.html#a7">00075</a> <a class="code" href="types_8h.html#a9">LongNatural</a> <a class="code" href="classSobol.html#a7">Sobol::Min</a>() {
00076     <span class="keywordflow">return</span> 1;
00077 }
00078 
<a name="l00079"></a><a class="code" href="classSobol.html#a3">00079</a> <a class="code" href="types_8h.html#a9">LongNatural</a> <a class="code" href="classSobol.html#a3">Sobol::GetOneRandomInteger</a>()
00080 {
00081         <span class="keywordflow">return</span> 1;
00082 }
00083 
<a name="l00084"></a><a class="code" href="classSobol.html#a4">00084</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classSobol.html#a4">Sobol::getUniform</a>()
00085 {
00086         <a class="code" href="classSobol.html#a2">sobseq</a>(&amp;<a class="code" href="classSobol.html#r1">n_</a>,<a class="code" href="classSobol.html#r2">x_</a>);
00087         <span class="keywordflow">return</span> <a class="code" href="classSobol.html#r2">x_</a>[1];
00088 }
</pre></div><hr size="1"><address style="align: right;"><small>
<b>Note: Generated nightly - reload for latest version</b><br>
Generated on Thu Dec 22 13:21:44 2005 for <a href="http://terreneuve.sourceforge.net">terreneuve</a> by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.3.6</small></address>
</body>
</html>
