<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mainyieldcurves.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>mainyieldcurves.cpp</h1><a href="mainyieldcurves_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include"..\PartB\yieldCurve.h"</span>
00002 <span class="preprocessor">#include "../common/filereader.h"</span>
00003 
00004 <span class="preprocessor">#include&lt;iostream&gt;</span>
00005 <span class="preprocessor">#include&lt;valarray&gt;</span>
00006 <span class="preprocessor">#include&lt;time.h&gt;</span>
00007 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00008 
<a name="l00013"></a><a class="code" href="mainyieldcurves_8cpp.html#a0">00013</a> <span class="keywordtype">bool</span> <a class="code" href="testObjects_8h.html#a7">mainyieldcurve</a>(<span class="keywordtype">void</span>) {
00014         string datadir = <a class="code" href="classFileReader.html#e4">FileReader::getdatadirasstring</a>();
00015         string yieldCurveData = datadir + <span class="stringliteral">"yctest.csv"</span>;
00016         <a class="code" href="types_8h.html#a10">Real</a> shift=0.001,calculation=0.,matRotation=7;
00017         <span class="keywordtype">bool</span> fctnResult=<span class="keyword">true</span>;
00018 
00019         <span class="comment">// the underlying curve</span>
00020         valarray&lt;yieldPoint&gt; *rates = 
00021                 <a class="code" href="classFileReader.html#e5">FileReader::buildYieldPointArray</a>(yieldCurveData);
00022 
00023         <a class="code" href="classyieldCurve.html">yieldCurve</a> testcurve=<a class="code" href="classyieldCurve.html">yieldCurve</a>(*rates,<span class="stringliteral">"test"</span>);
00024 
00025         valarray&lt;Real&gt; maturities = testcurve.<a class="code" href="classyieldCurve.html#a10">getMaturitiesInTheZCBCurve</a>();
00026         valarray&lt;Real&gt; ZCB(maturities.size());
00027 
00028         yieldCurve ycShifted=testcurve.<a class="code" href="classyieldCurve.html#a4">shiftZCBRateCurve</a>(shift);
00029         valarray&lt;Real&gt; ZCBShift(maturities.size());
00030         yieldCurve ycRotated=testcurve.<a class="code" href="classyieldCurve.html#a5">rotateZCBRateCurve</a>(shift,matRotation);
00031         valarray&lt;Real&gt; ZCBRotate(maturities.size());
00032         
00033         cout&lt;&lt;fctnResult&lt;&lt;endl;
00034 
00035         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a7">Natural</a> i = 0; i &lt; ZCB.size(); i++) {
00036                 ZCB[i] = testcurve.<a class="code" href="classyieldCurve.html#a8">spotRate</a>(maturities[i]);
00037                 ZCBShift[i]=ycShifted.<a class="code" href="classyieldCurve.html#a8">spotRate</a>(maturities[i]);
00038                 fctnResult&amp;=(ZCBShift[i]==ZCB[i]+shift);
00039         }
00040 
00041         <span class="keywordflow">for</span>(i=0;i&lt;rates-&gt;size();i++)
00042                 cout &lt;&lt; <span class="stringliteral">"Mkt Rate: "</span> &lt;&lt; (*rates)[i].getRate()*100 &lt;&lt; <span class="stringliteral">" (mat: "</span> &lt;&lt; (*rates)[i].getMaturity()
00043                         &lt;&lt; <span class="stringliteral">" ; type: "</span> &lt;&lt; (*rates)[i].getType() &lt;&lt; <span class="stringliteral">")"</span>&lt;&lt;endl;
00044 
00045         cout &lt;&lt; <span class="stringliteral">"ZCB rates:\n"</span> &lt;&lt; testcurve &lt;&lt; endl;
00046 
00047         string filename = <a class="code" href="classFileReader.html#e4">FileReader::getdatadirasstring</a>() + <span class="stringliteral">"test_YC_PCA.txt"</span>; 
00048         ofstream myfile(filename.c_str()); 
00049         myfile &lt;&lt; <span class="stringliteral">"Original curve\n"</span>&lt;&lt;testcurve&lt;&lt;<span class="stringliteral">"\n"</span>; 
00050         myfile &lt;&lt; <span class="stringliteral">"Shifted curve\n"</span>&lt;&lt;ycShifted&lt;&lt;<span class="stringliteral">"\n"</span>; 
00051         myfile &lt;&lt; <span class="stringliteral">"Rotated curve\n"</span>&lt;&lt;ycRotated&lt;&lt;<span class="stringliteral">"\n"</span>; 
00052         myfile &lt;&lt; <span class="stringliteral">"DF\n"</span>;
00053         <span class="keywordflow">for</span>(<a class="code" href="types_8h.html#a10">Real</a> T=0.25;T&lt;=30;T+=0.25)
00054                 myfile &lt;&lt; testcurve.discountFactor(T,<a class="code" href="yieldCurve_8h.html#a8a5">Continuous</a>)&lt;&lt;<span class="stringliteral">"\n"</span>;
00055         myfile &lt;&lt; <span class="stringliteral">"6m Fwd\n"</span>;
00056         <span class="keywordflow">for</span>(<a class="code" href="types_8h.html#a10">Real</a> T=0.25;T&lt;=29.5;T+=0.25)
00057                 myfile &lt;&lt; testcurve.forwardRate(0.5,T,<a class="code" href="yieldCurve_8h.html#a8a5">Continuous</a>)&lt;&lt;<span class="stringliteral">"\n"</span>;
00058         myfile.close();
00059 
00060 
00061         calculation=testcurve.spotRate (3.72);
00062         cout&lt;&lt;<span class="stringliteral">"\n Test Spot rate at 3.72 years "</span>&lt;&lt;calculation&lt;&lt;endl;
00063         fctnResult&amp;=(calculation&gt;=0.0463701)&amp;&amp;(calculation&lt;=0.0463702);
00064 
00065         calculation=testcurve.spotRate (14);
00066         cout&lt;&lt;<span class="stringliteral">"\n Test Spot rate at 14 years "</span>&lt;&lt;calculation&lt;&lt;endl;
00067         fctnResult&amp;=(calculation&gt;=0.0494384)&amp;&amp;(calculation&lt;=0.0494385);
00068 
00069         calculation =testcurve.discountFactor (5.6,<a class="code" href="yieldCurve_8h.html#a8a5">Continuous</a>);
00070         cout&lt;&lt;<span class="stringliteral">"\n Test DF at 5.6 years cont "</span>&lt;&lt;calculation &lt;&lt;endl;
00071         fctnResult&amp;=(calculation&gt;=0.7688138)&amp;&amp;(calculation&lt;=0.7688142);
00072 
00073         calculation =testcurve.discountFactor (5.6,<a class="code" href="yieldCurve_8h.html#a8a4">Discrete</a>);
00074         cout&lt;&lt;<span class="stringliteral">"\n Test DF at 5.6 years disc "</span>&lt;&lt;calculation &lt;&lt;endl;
00075         fctnResult&amp;=(calculation&gt;=0.7734288)&amp;&amp;(calculation&lt;=0.7734292);
00076         
00077         calculation =testcurve.discountFactor (1.5);
00078         cout&lt;&lt;<span class="stringliteral">"\n Test DF at 1.5 years "</span>&lt;&lt;calculation&lt;&lt;endl;
00079         fctnResult&amp;=(calculation&gt;=0.934078)&amp;&amp;(calculation&lt;=0.934079);
00080 
00081         <a class="code" href="classDate.html">Date</a> d=<a class="code" href="classDate.html">Date</a>();
00082         d.<a class="code" href="classDate.html#a13">setDateToToday</a> ();
00083         calculation =testcurve.discountFactor(d.<a class="code" href="classDate.html#a30">plusMonths</a>(18));
00084         cout&lt;&lt;<span class="stringliteral">"\n Test from today to 18 months : "</span>&lt;&lt;calculation&lt;&lt;endl;
00085         fctnResult&amp;=(calculation&gt;=0.930458)&amp;&amp;(calculation&lt;=0.930459);
00086 
00087         calculation=testcurve.discountFactor (Date(18,(<a class="code" href="date_8h.html#a44">Month</a>)6,2007));
00088         cout&lt;&lt;<span class="stringliteral">"\n Test DF in Date (18/6/2007)"</span>&lt;&lt;calculation &lt;&lt;endl;
00089         fctnResult&amp;=(calculation&gt;=0.930458)&amp;&amp;(calculation&lt;=0.930459);
00090 
00091         calculation=testcurve.discountFactor (4);
00092         cout&lt;&lt;<span class="stringliteral">"\n Test DF at 4 years "</span>&lt;&lt;calculation&lt;&lt;endl;
00093         fctnResult&amp;=(calculation&gt;=0.830441)&amp;&amp;(calculation&lt;=0.830442);
00094 
00095         calculation=testcurve.forwardRate(1.5,2.5,<a class="code" href="yieldCurve_8h.html#a8a5">Continuous</a>);
00096         cout&lt;&lt;<span class="stringliteral">"\n Test FWD at (1.5,2.5) &lt;=&gt; 4 years maturity cont "</span>&lt;&lt;calculation&lt;&lt;endl;
00097         fctnResult&amp;=(calculation&gt;=0.0470409)&amp;&amp;(calculation&lt;=0.0470410);
00098 
00099         calculation=testcurve.forwardRate(1.5,2.5,<a class="code" href="yieldCurve_8h.html#a8a4">Discrete</a>);
00100         cout&lt;&lt;<span class="stringliteral">"\n Test FWD at (1.5,2.5) &lt;=&gt; 4 years maturity disc "</span>&lt;&lt;calculation&lt;&lt;endl;
00101         fctnResult&amp;=(calculation&gt;=0.0470413)&amp;&amp;(calculation&lt;=0.0470414);
00102 
00103         <span class="keywordflow">return</span> fctnResult;
00104 }
</pre></div><hr size="1"><address style="align: right;"><small>
<b>Note: Generated nightly - reload for latest version</b><br>
Generated on Thu Dec 22 13:21:44 2005 for <a href="http://terreneuve.sourceforge.net">terreneuve</a> by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.3.6</small></address>
</body>
</html>
