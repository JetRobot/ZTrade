<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>maincreditcurves.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>maincreditcurves.cpp</h1><a href="maincreditcurves_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include "..\PartF\creditCurve.h"</span>
00002 <span class="preprocessor">#include "..\common\filereader.h"</span>
00003 
00004 <span class="preprocessor">#include&lt;iostream&gt;</span>
00005 <span class="preprocessor">#include&lt;valarray&gt;</span>
00006 <span class="preprocessor">#include&lt;time.h&gt;</span>
00007 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00008 
<a name="l00009"></a><a class="code" href="maincreditcurves_8cpp.html#a0">00009</a> <span class="keywordtype">bool</span> <a class="code" href="testObjects_8h.html#a12">maincreditcurve</a>(<span class="keywordtype">void</span>) {
00010         string datadir = <a class="code" href="classFileReader.html#e4">FileReader::getdatadirasstring</a>();
00011         string yieldCurveData = datadir + <span class="stringliteral">"yctest.csv"</span>;
00012         string creditSpreadData = datadir + <span class="stringliteral">"ccspread.csv"</span>;
00013         string creditSpreadMixedData = datadir + <span class="stringliteral">"ccspreadmix.csv"</span>;
00014         string creditSpreadZeroData = datadir + <span class="stringliteral">"cc0spread.csv"</span>;
00015         string aigSpreadData = datadir + <span class="stringliteral">"cdsw_aig.csv"</span>;
00016 
00017         <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;
00018 
00019         <span class="comment">// the underlying curve</span>
00020         valarray&lt;yieldPoint&gt; *yieldCurveArray = 
00021                 <a class="code" href="classFileReader.html#e5">FileReader::buildYieldPointArray</a>(yieldCurveData);
00022 
00023         <span class="comment">// zero (relative) spreads</span>
00024         valarray&lt;CreditSpreadPoint&gt; *creditSpreadZeroArray =
00025                 <a class="code" href="classFileReader.html#e6">FileReader::buildCreditSpreadPointArray</a>(creditSpreadZeroData);
00026 
00027         <span class="comment">// absolute "spreads"   </span>
00028         valarray&lt;CreditSpreadPoint&gt; *creditSpreadArray =
00029                 <a class="code" href="classFileReader.html#e6">FileReader::buildCreditSpreadPointArray</a>(creditSpreadData);
00030 
00031         <span class="comment">// mixed absolute and relative spreads (equivalent to absolute</span>
00032         <span class="comment">//  when combined with the underlying yield curve)</span>
00033         valarray&lt;CreditSpreadPoint&gt; *creditSpreadMixedArray =
00034                 <a class="code" href="classFileReader.html#e6">FileReader::buildCreditSpreadPointArray</a>(creditSpreadMixedData);
00035 
00036         <span class="comment">// AIG credit swap spreads from bloomberg</span>
00037         valarray&lt;CreditSpreadPoint&gt; *aigSpreadArray =
00038                 <a class="code" href="classFileReader.html#e6">FileReader::buildCreditSpreadPointArray</a>(aigSpreadData);
00039 
00040         <span class="keywordflow">if</span> ((yieldCurveArray == NULL) || 
00041                 (creditSpreadArray == NULL) ||
00042                 (creditSpreadZeroArray == NULL) ||
00043                 (creditSpreadMixedArray == NULL)) {
00044                 cout &lt;&lt; <span class="stringliteral">"error reading in credit curve test files"</span> &lt;&lt; endl;
00045                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00046         }
00047 
00048         <span class="comment">// test: NOSPREAD</span>
00049         <span class="comment">// construct a credit curve with no spread, verify that</span>
00050         <span class="comment">//  it returns the same values as the underlying yieldcurve</span>
00051         <a class="code" href="classcreditCurve.html">creditCurve</a> zeroSpreadCurve(*yieldCurveArray, 
00052                 *creditSpreadZeroArray, 
00053                 <span class="stringliteral">"zero-spread"</span>);
00054 
00055         <span class="comment">// underlying yield curve which we can use for comparisons</span>
00056         <a class="code" href="classyieldCurve.html">yieldCurve</a> underlyingCurve(*yieldCurveArray, <span class="stringliteral">"test"</span>);
00057 
00058         <span class="keywordflow">if</span> (zeroSpreadCurve != underlyingCurve) {
00059                 cout &lt;&lt; <span class="stringliteral">"error: zero spread spot rates don't match the underlying"</span> &lt;&lt; endl;
00060                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00061         }
00062 
00063         <span class="comment">// test: MIXEDSPREAD</span>
00064         <span class="comment">// now construct a curve with spreads, one with absolute and</span>
00065         <span class="comment">//  one with a mix of absolute and relative, but both are</span>
00066         <span class="comment">//  equivalent (given the same underlying yieldCurve)</span>
00067         <a class="code" href="classcreditCurve.html">creditCurve</a> absCurve(*yieldCurveArray, 
00068                 *creditSpreadArray, 
00069                 <span class="stringliteral">"abs-spreads"</span>);
00070 
00071         <a class="code" href="classcreditCurve.html">creditCurve</a> mixedCurve(*yieldCurveArray, 
00072                 *creditSpreadMixedArray, 
00073                 <span class="stringliteral">"mixed-spreads"</span>);
00074         
00075         cout &lt;&lt; <span class="stringliteral">"zeroSpreadCurve:\n"</span> &lt;&lt; zeroSpreadCurve &lt;&lt; endl;
00076         cout &lt;&lt; <span class="stringliteral">"absCurve:\n"</span> &lt;&lt; absCurve &lt;&lt; endl;
00077         cout &lt;&lt; <span class="stringliteral">"mixedCurve:\n"</span> &lt;&lt; mixedCurve &lt;&lt; endl;
00078         <span class="keywordflow">if</span> (absCurve != mixedCurve) {
00079                 cout &lt;&lt; <span class="stringliteral">"error: absolute spread spot rates don't match mixed curve"</span> &lt;&lt; endl;
00080                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00081         }
00082 
00083         <span class="comment">// test: CTORTEST</span>
00084         <a class="code" href="classcreditCurve.html">creditCurve</a> mixedCurve2(underlyingCurve, 
00085                 *creditSpreadMixedArray,
00086                 <span class="stringliteral">"mixed-spreads2"</span>);
00087         cout &lt;&lt; <span class="stringliteral">"mixedCurve2:\n"</span> &lt;&lt; mixedCurve2 &lt;&lt; endl;
00088         <span class="keywordflow">if</span> (mixedCurve != mixedCurve2) {
00089                 cout &lt;&lt; <span class="stringliteral">"error: constructing with yieldpoints gives different result"</span>
00090                         &lt;&lt; <span class="stringliteral">" than constructing with yieldcurve"</span> &lt;&lt; endl;
00091                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00092         }
00093 
00094         <a class="code" href="types_8h.html#a10">Real</a> flatRate = 0.04;  <a class="code" href="types_8h.html#a10">Real</a> flatSpread = 0.01;
00095         <a class="code" href="classcreditCurve.html">creditCurve</a> flatCreditCurve(flatRate, 
00096                 flatSpread);
00097         <a class="code" href="classyieldCurve.html">yieldCurve</a> flatYieldCurve(flatRate + flatSpread);
00098         
00099         cout &lt;&lt; <span class="stringliteral">"flatCreditCurve:\n"</span> &lt;&lt; flatCreditCurve &lt;&lt; endl;
00100         cout &lt;&lt; <span class="stringliteral">"flatYieldCurve:\n"</span> &lt;&lt; flatYieldCurve &lt;&lt; endl;
00101         <span class="keywordflow">if</span> (flatYieldCurve != flatCreditCurve) {
00102                 cout &lt;&lt; <span class="stringliteral">"error: flat 0.04 + 0.01 creditcurve gives different result"</span>
00103                         &lt;&lt; <span class="stringliteral">" than flat 0.05 yieldcurve"</span> &lt;&lt; endl;
00104                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00105         }
00106 
00107         <span class="comment">// test: COPYCTORTEST</span>
00108         <a class="code" href="classcreditCurve.html">creditCurve</a> *pcreditCurve = <span class="keyword">new</span> <a class="code" href="classcreditCurve.html">creditCurve</a>(*yieldCurveArray, 
00109                 *creditSpreadArray, 
00110                 <span class="stringliteral">"abs-spreads"</span>);
00111         creditCurve copyCurve(*pcreditCurve);
00112         creditCurve equalCurve = copyCurve;
00113         <span class="keyword">delete</span> pcreditCurve;
00114         cout &lt;&lt; <span class="stringliteral">"copycurve: "</span> &lt;&lt; copyCurve &lt;&lt; endl;
00115         cout &lt;&lt; <span class="stringliteral">"equalcurve: "</span> &lt;&lt; equalCurve &lt;&lt; endl;
00116 
00117         <span class="comment">// test: HULLS21.3TEST</span>
00118         flatRate = 0.05;  flatSpread = 0.0126;
00119         creditCurve flatCreditCurve2(flatRate, flatSpread);
00120         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a7">Natural</a> i = 0; i &lt;= 5; i++) {
00121                 cout &lt;&lt; <span class="stringliteral">"prob of default at time "</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">","</span> 
00122                         &lt;&lt; flatCreditCurve2.<a class="code" href="classcreditCurve.html#a21">defaultProbability</a>(i) &lt;&lt; <span class="stringliteral">","</span>
00123                         &lt;&lt; <span class="stringliteral">"survival prob,"</span> 
00124                         &lt;&lt; flatCreditCurve2.<a class="code" href="classcreditCurve.html#a18">survivalProbability</a>(i) &lt;&lt; endl;
00125         }
00126 
00127         <span class="comment">// test: AIGTEST</span>
00128         creditCurve aigCurve(flatYieldCurve, *aigSpreadArray, <span class="stringliteral">"aigcurve"</span>);
00129         cout &lt;&lt; <span class="stringliteral">"aigCurve: "</span> &lt;&lt; aigCurve &lt;&lt; endl;
00130         cout &lt;&lt; <span class="stringliteral">"\n\n*** table of various values for aig curve"</span> &lt;&lt; endl;
00131         cout &lt;&lt; <span class="stringliteral">"time,creditspread,hazardrate,survivalprob,cumdefaultprob,riskydiscount"</span> &lt;&lt; endl;
00132         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a7">Natural</a> i = 0; i &lt;= 10; i++) {
00133                 cout &lt;&lt; i &lt;&lt; <span class="stringliteral">","</span>
00134                         &lt;&lt; aigCurve.<a class="code" href="classcreditCurve.html#a12">creditSpread</a>(i) &lt;&lt; <span class="stringliteral">","</span>
00135                         &lt;&lt; aigCurve.<a class="code" href="classcreditCurve.html#a22">hazardRate</a>(i) &lt;&lt; <span class="stringliteral">","</span>
00136                         &lt;&lt; aigCurve.<a class="code" href="classcreditCurve.html#a18">survivalProbability</a>(i) &lt;&lt; <span class="stringliteral">","</span>
00137                         &lt;&lt; aigCurve.<a class="code" href="classcreditCurve.html#a19">cumulativeDefaultProbability</a>(i) &lt;&lt; <span class="stringliteral">","</span>
00138                         &lt;&lt; aigCurve.<a class="code" href="classcreditCurve.html#a26">riskyDiscountFactor</a>(i) &lt;&lt; endl;
00139         }
00140 
00141         <span class="keywordflow">return</span> result;
00142 }
</pre></div><hr size="1"><address style="align: right;"><small>
<b>Note: Generated nightly - reload for latest version</b><br>
Generated on Thu Dec 22 13:21:44 2005 for <a href="http://terreneuve.sourceforge.net">terreneuve</a> by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.3.6</small></address>
</body>
</html>
