<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Drift.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>Drift.cpp</h1><a href="Drift_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include "../../common\types.h"</span>
00002 <span class="preprocessor">#include "./drift.h"</span>
00003 <span class="preprocessor">#include &lt;math.h&gt;</span>
00004 
<a name="l00005"></a><a class="code" href="classDrift.html#a0">00005</a> <a class="code" href="classDrift.html#a1">Drift::Drift</a>(<a class="code" href="classDate.html">Date</a> startDate, <a class="code" href="types_8h.html#a10">Real</a> ExpiryInYears,<a class="code" href="types_8h.html#a9">LongNatural</a>&amp; nDates,<a class="code" href="classyieldCurve.html">yieldCurve</a>* pyieldCurve,<a class="code" href="classvolsurface.html">volsurface</a>* pvolsurface, <a class="code" href="types_8h.html#a10">Real</a> Strike)
00006                                                                         :       m_nDates(nDates)
00007 {
00008         <a class="code" href="classDrift.html#r0">vDates</a>.resize(nDates+1);
00009         <a class="code" href="classDate.html">Date</a> stepDate=<a class="code" href="classDate.html">Date</a>();
00010         <span class="comment">//Build dates with constant step</span>
00011         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a7">Natural</a> i=0;i&lt;nDates+1;++i) {
00012                 stepDate=startDate.<a class="code" href="classDate.html#a28">plusDays</a>((<a class="code" href="types_8h.html#a7">Natural</a>)(365*ExpiryInYears*i/nDates));
00013                 <a class="code" href="classDrift.html#r0">vDates</a>[i]=stepDate.<a class="code" href="classDate.html#a10">serialNumber</a>();
00014         }
00015         <span class="comment">//Memory allocation for vDrift</span>
00016         <a class="code" href="classDrift.html#r1">vDrift</a>.resize(nDates);
00017         <span class="comment">//Build drift path according to Ito's formula</span>
00018         Date startStep,endStep;
00019         <span class="keywordflow">for</span> (i=0;i&lt;nDates;++i) {
00020                 startStep=Date(<a class="code" href="classDrift.html#r0">vDates</a>[i]);
00021                 endStep=Date(<a class="code" href="classDrift.html#r0">vDates</a>[i+1]);
00022                 <a class="code" href="classDrift.html#r1">vDrift</a>[i]=(pyieldCurve-&gt;<a class="code" href="classyieldCurve.html#a15">forwardRate</a>(startStep,endStep)-0.5*pow(pvolsurface-&gt;<a class="code" href="classvolsurface.html#a9">forwardVolatility</a>(Strike,startStep,endStep),2))*(<a class="code" href="classDrift.html#r0">vDates</a>[i+1]-<a class="code" href="classDrift.html#r0">vDates</a>[i])/365;
00023         }
00024 }
00025 
<a name="l00026"></a><a class="code" href="classDrift.html#a1">00026</a> <a class="code" href="classDrift.html#a1">Drift::Drift</a>(<span class="keywordtype">void</span>)
00027 {
00028 }
00029 
<a name="l00030"></a><a class="code" href="classDrift.html#a2">00030</a> <a class="code" href="classDrift.html#a1">Drift::Drift</a>(<a class="code" href="classDate.html">Date</a> startDate, <a class="code" href="types_8h.html#a10">Real</a> ExpiryInYears,<a class="code" href="types_8h.html#a10">Real</a> rateToMaturity,<a class="code" href="types_8h.html#a10">Real</a> volToMaturity)
00031 {
00032         <a class="code" href="classDrift.html#r2">m_nDates</a>=1;
00033         <a class="code" href="classDrift.html#r0">vDates</a>.resize(<a class="code" href="classDrift.html#r2">m_nDates</a>+1);
00034         <a class="code" href="classDate.html">Date</a> stepDate=<a class="code" href="classDate.html">Date</a>();
00035         <span class="comment">//Build dates with constant step -- useless but allocation for the getvDates necessary for Gaussian process.</span>
00036         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a7">Natural</a> i=0;i&lt;<a class="code" href="classDrift.html#r2">m_nDates</a>+1;++i) {
00037                 stepDate=startDate.<a class="code" href="classDate.html#a28">plusDays</a>((<a class="code" href="types_8h.html#a7">Natural</a>)(365*ExpiryInYears*i/<a class="code" href="classDrift.html#r2">m_nDates</a>));
00038                 <a class="code" href="classDrift.html#r0">vDates</a>[i]=stepDate.<a class="code" href="classDate.html#a10">serialNumber</a>();
00039         }
00040 
00041         <span class="comment">//Memory allocation for vDrift</span>
00042         <a class="code" href="classDrift.html#r1">vDrift</a>.resize(<a class="code" href="classDrift.html#r2">m_nDates</a>);
00043         <span class="comment">//Build drift path according to Ito's formula</span>
00044         <a class="code" href="classDrift.html#r1">vDrift</a>[0]=(rateToMaturity-0.5*pow(volToMaturity,2))*ExpiryInYears;
00045 }
00046 
<a name="l00047"></a><a class="code" href="classDrift.html#a3">00047</a> <a class="code" href="classDrift.html#a3">Drift::~Drift</a>()
00048 {
00049 }
00050 
<a name="l00051"></a><a class="code" href="classDrift.html#a4">00051</a> valarray&lt;Real&gt; <a class="code" href="classDrift.html#a4">Drift::GetvDrift</a>(<span class="keywordtype">void</span>)
00052 {
00053         valarray&lt;Real&gt; Driftarray;
00054         Driftarray.resize(<a class="code" href="classDrift.html#r2">m_nDates</a>);
00055         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a7">Natural</a> i=0;i&lt;<a class="code" href="classDrift.html#r2">m_nDates</a>;++i)
00056                 Driftarray[i]=<a class="code" href="classDrift.html#r1">vDrift</a>[i];
00057         <span class="keywordflow">return</span> Driftarray;
00058 }
00059 
<a name="l00060"></a><a class="code" href="classDrift.html#a5">00060</a> <a class="code" href="types_8h.html#a10">Real</a> <a class="code" href="classDrift.html#a5">Drift::GetDriftattimei</a>(<a class="code" href="types_8h.html#a9">LongNatural</a> i)
00061 {
00062         <span class="keywordflow">if</span> (i&lt;<a class="code" href="classDrift.html#r2">m_nDates</a>)
00063                 <span class="keywordflow">return</span> <a class="code" href="classDrift.html#r1">vDrift</a>[i];
00064         <span class="keywordflow">else</span>
00065                 <span class="keywordflow">return</span> 0.;
00066 }
00067 
<a name="l00068"></a><a class="code" href="classDrift.html#a6">00068</a> valarray&lt;LongInteger&gt; <a class="code" href="classDrift.html#a6">Drift::GetvDates</a>(<span class="keywordtype">void</span>)
00069 {
00070         valarray&lt;LongInteger&gt; Datesarray;
00071         Datesarray.resize(<a class="code" href="classDrift.html#r2">m_nDates</a>+1);
00072         <span class="keywordflow">for</span> (<a class="code" href="types_8h.html#a7">Natural</a> i=0;i&lt;<a class="code" href="classDrift.html#r2">m_nDates</a>+1;++i){
00073                 Datesarray[i]=<a class="code" href="classDrift.html#r0">vDates</a>[i];
00074         }
00075         <span class="keywordflow">return</span> Datesarray;
00076 }
00077 
<a name="l00078"></a><a class="code" href="classDrift.html#a7">00078</a> <a class="code" href="types_8h.html#a8">LongInteger</a> <a class="code" href="classDrift.html#a7">Drift::GetTimeBtwDates</a>(<a class="code" href="types_8h.html#a9">LongNatural</a> i,<a class="code" href="types_8h.html#a9">LongNatural</a> j)
00079 {
00080         <span class="keywordflow">if</span> (i&lt;<a class="code" href="classDrift.html#r2">m_nDates</a> &amp;&amp; j&lt;<a class="code" href="classDrift.html#r2">m_nDates</a>)
00081                 <span class="keywordflow">return</span> <a class="code" href="classDrift.html#r0">vDates</a>[j]-<a class="code" href="classDrift.html#r0">vDates</a>[i];
00082         <span class="keywordflow">else</span>
00083                 <span class="keywordflow">return</span> 0;
00084 }
</pre></div><hr size="1"><address style="align: right;"><small>
<b>Note: Generated nightly - reload for latest version</b><br>
Generated on Thu Dec 22 13:21:43 2005 for <a href="http://terreneuve.sourceforge.net">terreneuve</a> by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.3.6</small></address>
</body>
</html>
