<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>mainmontecarlo.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>mainmontecarlo.cpp</h1><a href="mainmontecarlo_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include "../Interface/main.h"</span>
00002 <span class="preprocessor">#include"../PartA/MonteCarlo1/ParkMiller.h"</span>
00003 <span class="preprocessor">#include"../PartA/MonteCarlo1/MersenneTwister.h"</span>
00004 <span class="preprocessor">#include"../PartA/MonteCarlo1/RandC.h"</span>
00005 <span class="preprocessor">#include"../PartA/MonteCarlo1/Sobol.h"</span>
00006 <span class="preprocessor">#include"../PartA/MonteCarlo1/GaussianProcess.h"</span>
00007 <span class="preprocessor">#include"../common/Normals.h"</span>
00008 <span class="preprocessor">#include"../PartA/MonteCarlo1/PayOff.h"</span>
00009 <span class="preprocessor">#include"../PartA/MonteCarlo1/Random.h"</span>
00010 <span class="preprocessor">#include"../PartB/YieldCurve.h"</span>
00011 <span class="preprocessor">#include"../PartA/MonteCarlo1/Drift.h"</span>
00012 <span class="preprocessor">#include"../PartA/MonteCarlo1/MCEngine.h"</span>
00013 <span class="preprocessor">#include "time.h"</span>
00014 
00015 <span class="preprocessor">#include&lt;iostream&gt;</span>
00016 <span class="preprocessor">#include&lt;valarray&gt;</span>
00017 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00018 
<a name="l00019"></a><a class="code" href="mainmontecarlo_8cpp.html#a0">00019</a> <span class="keywordtype">bool</span> <a class="code" href="testObjects_8h.html#a1">mainmontecarlo</a>(<span class="keywordtype">void</span>) {
00020     <a class="code" href="types_8h.html#a10">Real</a> spot=100, strike=110, vol=0.2, mat=1.,rate=0.02;
00021         <a class="code" href="types_8h.html#a9">LongNatural</a> nPaths=100000,nDates=1;
00022         <a class="code" href="classvolsurface.html">volsurface</a>* myvol=<span class="keyword">new</span> <a class="code" href="classvolsurface.html">volsurface</a>(vol);
00023         <a class="code" href="classyieldCurve.html">yieldCurve</a>* mycurve=<span class="keyword">new</span> <a class="code" href="classyieldCurve.html">yieldCurve</a>(rate);
00024         <span class="comment">//Set time</span>
00025         <a class="code" href="types_8h.html#a10">Real</a> tme;
00026         tme=clock();
00027         <a class="code" href="types_8h.html#a10">Real</a> mcPrice=<a class="code" href="mainmontecarlo_8cpp.html#a1">mainmc</a>(mat,strike,spot,myvol,mycurve,nPaths,nDates,1);
00028         tme=clock()-tme;
00029         cout&lt;&lt;<span class="stringliteral">"MC price"</span>&lt;&lt;endl;
00030         cout&lt;&lt;mcPrice&lt;&lt;endl;
00031         cout&lt;&lt;<span class="stringliteral">"MC time"</span>&lt;&lt;endl;
00032         cout&lt;&lt;tme/1000.&lt;&lt;endl;
00033         <span class="keywordflow">if</span> (mcPrice&gt;4.96 || mcPrice&lt;4.92) {
00034                 cout &lt;&lt;<span class="stringliteral">"did not get expected result for MC pricer - Part A"</span>&lt;&lt;endl;
00035                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00036         } <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">true</span>;
00037 }
00038 
00039 <a class="code" href="types_8h.html#a10">Real</a> 
<a name="l00040"></a><a class="code" href="mainmontecarlo_8cpp.html#a1">00040</a> <a class="code" href="mainmontecarlo_8cpp.html#a1">mainmc</a>(<a class="code" href="types_8h.html#a10">Real</a> Expiry, <a class="code" href="types_8h.html#a10">Real</a> Strike, <a class="code" href="types_8h.html#a10">Real</a> Spot, <a class="code" href="classvolsurface.html">volsurface</a>* pvolsurface, <a class="code" href="classyieldCurve.html">yieldCurve</a>* pyieldCurve,
00041            <a class="code" href="types_8h.html#a9">LongNatural</a> nPaths, <a class="code" href="types_8h.html#a9">LongNatural</a> nDates, <a class="code" href="types_8h.html#a6">Integer</a> PrdName)
00042 {
00043         <a class="code" href="types_8h.html#a10">Real</a> initialHazardRate,meanReversionSpeed,price=0;
00044         valarray &lt;Real&gt; vStepIncrements,vDrift;
00045         valarray &lt;Real&gt; vPath;
00046         valarray &lt;Real&gt; vDiscFactors;
00047         valarray&lt;Real&gt; uniformSample;
00048         valarray &lt;Real&gt; gaussianSample;
00049         valarray&lt;LongInteger&gt; vDates;
00050         <a class="code" href="types_8h.html#a9">LongNatural</a> i,seed;
00051         
00052         <span class="comment">//seed  </span>
00053         seed = 100000000;
00054 
00055         <span class="comment">//initialisation of arrays</span>
00056         vPath.resize(nDates);
00057         vStepIncrements.resize(nDates);
00058         vDiscFactors.resize(nDates);
00059         vDrift.resize(nDates);
00060         vDates.resize(nDates+1);
00061         uniformSample.resize(nDates);
00062         gaussianSample.resize(nDates);
00063 
00064         <span class="keyword">const</span> <a class="code" href="types_8h.html#a10">Real</a> constRate=<a class="code" href="ParkMiller_8h.html#a3">r</a>;
00065         initialHazardRate=Spot;
00066         meanReversionSpeed=0.;
00067 
00068         <a class="code" href="classDate.html">Date</a> Today=<a class="code" href="classDate.html">Date</a>();
00069         Today.<a class="code" href="classDate.html#a13">setDateToToday</a>();
00070 
00071         <span class="comment">//initialisation of drift</span>
00072         <a class="code" href="classDrift.html">Drift</a>* pDrift = <span class="keyword">new</span> <a class="code" href="classDrift.html">Drift</a>(Today, Expiry,nDates,pyieldCurve,pvolsurface,Strike);
00073         vDrift=pDrift-&gt;<a class="code" href="classDrift.html#a4">GetvDrift</a>();
00074         vDates=pDrift-&gt;<a class="code" href="classDrift.html#a6">GetvDates</a>();
00075 
00076         <span class="comment">//initialisation of uniform number generator</span>
00077         <a class="code" href="classMersenneTwister.html">MersenneTwister</a>* pRandGen = <span class="keyword">new</span> <a class="code" href="classMersenneTwister.html">MersenneTwister</a>(seed);
00078 
00079         <span class="comment">//initialisation of random generator</span>
00080         <a class="code" href="classRandom.html">Random</a>* pRandom = <span class="keyword">new</span> <a class="code" href="classRandom.html">Random</a>(nDates,pRandGen);
00081         
00082         <span class="comment">//initialisation of gaussian process</span>
00083         <a class="code" href="classGaussianProcess.html">GaussianProcess</a>* pGaussianProcess = <span class="keyword">new</span> <a class="code" href="classGaussianProcess.html">GaussianProcess</a>(vDates,nDates,initialHazardRate,vDrift,meanReversionSpeed,pvolsurface,Strike);
00084         
00085         <span class="comment">//initialisation of default jump process </span>
00086         pGaussianProcess-&gt;<a class="code" href="classGaussianProcess.html#a6">GetStepIncrements</a>(vStepIncrements);
00087         
00088         <span class="comment">//initialisation of payoff function</span>
00089         <a class="code" href="classPayOff.html">PayOff</a> thePayOff(Strike);
00090 
00091         <span class="comment">//initialisation of yield curve</span>
00092         <span class="keywordflow">for</span> (i=0;i&lt;nDates;++i)
00093                 vDiscFactors[i] = pyieldCurve-&gt;<a class="code" href="classyieldCurve.html#a12">discountFactor</a>((i+1)*Expiry/nDates);
00094 
00095         <a class="code" href="classMCEngine.html">MCEngine</a>* pMCEngine = <span class="keyword">new</span> <a class="code" href="classMCEngine.html">MCEngine</a>(nPaths,nDates,vDiscFactors);
00096         pMCEngine-&gt;<a class="code" href="classMCEngine.html#a22">RunEngineGeneral</a>(pRandom,pGaussianProcess,thePayOff,gaussianSample,vPath,PrdName);
00097         price=pMCEngine-&gt;<a class="code" href="classMCEngine.html#a23">MCResult</a>();
00098         pRandom-&gt;<a class="code" href="classRandom.html#a7">SetSeed</a>(seed);
00099 
00100         <span class="keyword">delete</span> pyieldCurve;
00101         <span class="keyword">delete</span> pvolsurface;
00102         <span class="keyword">delete</span> pDrift;
00103         <span class="keyword">delete</span> pRandom;
00104         <span class="keyword">delete</span> pGaussianProcess;
00105 
00106         <span class="keywordflow">return</span> price;
00107 
00108 }
</pre></div><hr size="1"><address style="align: right;"><small>
<b>Note: Generated nightly - reload for latest version</b><br>
Generated on Thu Dec 22 13:21:44 2005 for <a href="http://terreneuve.sourceforge.net">terreneuve</a> by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.3.6</small></address>
</body>
</html>
